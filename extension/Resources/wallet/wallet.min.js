function precisionToSatoshiBN(a){return Bitcoin.Util.parseValue(a).divide(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)).toString()))}function precisionToBTC(a){return Bitcoin.Util.formatValue(precisionToSatoshiBN(a))}function precisionFromBTC(a){return Bitcoin.Util.formatValue(Bitcoin.Util.parseValue(a).multiply(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)))))}function formatPrecision(a){return formatBTC(precisionToSatoshiBN(a).toString())}var MyWallet=new function(){var h=this;this.skip_init=false;var D="abcaa314-6f67-6705-b384-5d47fbe9d7cc";var aj;var M;var j;var aH;var al;var w;var d;var ay=0;var S=0;var at=0;var K=0;var aS=0;var aF;var g={};var E=[];var F=false;var aw=0;var ar=0;var aB=1000;var I={};var az;var an;var x=0.5;var ag=10;var P=ag;var b={};var q;var aN=0;var U;var Z=[];var B;var N=60000;var A=false;var aa;var aq=false;var X="en";var ap=2;var Q=0;var aK=0;var Y=false;var s={pbkdf2_iterations:ag,fee_policy:0,html5_notifications:false,logout_time:600000,tx_display:0,always_keep_local_backup:false};this.setEncryptedWalletData=function(aU){if(!aU||aU.length==0){aj=null;az=null;return}aj=aU;az=ah();try{if(aN==0||s.always_keep_local_backup){MyStore.put("payload",aj)}}catch(aV){console.log(aV)}};this.setRealAuthType=function(aU){aN=aU};this.getLanguage=function(){return X};this.setLanguage=function(aU){console.log("put "+aU);MyStore.put("language",aU);X=aU};this.addEventListener=function(aU){Z.push(aU)};this.getLogoutTime=function(){return s.logout_time};this.getSecondPasswordPbkdf2Iterations=function(){return s.pbkdf2_iterations};this.getMainPasswordPbkdf2Iterations=function(){return P};this.getDefaultPbkdf2Iterations=function(){return ag};this.setLogoutTime=function(aU){s.logout_time=aU;clearInterval(U);U=setTimeout(h.logout,h.getLogoutTime())};this.getDoubleEncryption=function(){return F};this.getEncryptedWalletData=function(){return aj};this.getFeePolicy=function(){return s.fee_policy};this.setFeePolicy=function(aU){s.fee_policy=parseInt(aU)};this.setAlwaysKeepLocalBackup=function(aU){s.always_keep_local_backup=aU};this.getAlwaysKeepLocalBackup=function(){return s.always_keep_local_backup};this.getGuid=function(){return M};this.getHTML5Notifications=function(){return s.html5_notifications};this.setHTML5Notifications=function(aU){s.html5_notifications=aU};this.getTransactions=function(){return E};this.addressExists=function(aU){return I[aU]!=null};this.getAddressTag=function(aU){return I[aU].tag};this.setAddressTag=function(aV,aU){I[aV].tag=aU};this.getAddressBook=function(){return g};this.getAddressLabel=function(aU){return I[aU].label};this.setAddressLabel=function(aU,aV){I[aU].label=aV};this.setAddressBalance=function(aU,aV){I[aU].balance=aV};this.getAddressBookLabel=function(aU){return g[aU]};this.isWatchOnly=function(aU){return !I[aU]||I[aU].priv==null};this.getAddressBalance=function(aU){return I[aU].balance};this.getMixerFee=function(){return x};this.deleteAddress=function(aU){delete I[aU]};this.addAddressBookEntry=function(aV,aU){g[aV]=aU};this.getPrivateKey=function(aU){return I[aU].priv};this.setLabel=function(aU,aV){I[aU].label=aV;ai();c()};this.securePost=function(aU,aX,a4,a1){var a0=jQuery.extend({},aX);if(!aX.sharedKey){if(!d||d.length==0||d.length!=36){throw"Shared key is invalid"}var aV=new Date().getTime();var aZ=parseInt((aV-aK)/10000);var aY=Crypto.SHA256(d.toLowerCase()+aZ);var aW=0;var a3=aY.substring(aW,aW+=8)+"-"+aY.substring(aW,aW+=4)+"-"+aY.substring(aW,aW+=4)+"-"+aY.substring(aW,aW+=4)+"-"+aY.substring(aW,aW+=12);a0.sharedKey=a3;a0.sKTimestamp=aZ;a0.sKDebugHexHash=aY;a0.sKDebugTimeOffset=aK;a0.sKDebugOriginalClientTime=aV;a0.sKDebugOriginalSharedKey=d}if(!aX.guid){a0.guid=M}a0.format=aX.format?aX.format:"plain";var a2="text";if(aX.format=="json"){a2="json"}$.ajax({dataType:a2,type:"POST",url:root+aU,data:a0,success:a4,error:a1})};this.isCorrectMainPassword=function(aU){return aH==aU};function ae(aV,aX){var aU=Crypto.SHA256(aV,{asBytes:true});for(var aW=1;aW<aX;++aW){aU=Crypto.SHA256(aU,{asBytes:true})}return Crypto.util.bytesToHex(aU)}this.setPbkdf2Iterations=function(aU,aW){var aV=function(aX){console.log("Panic "+aX);window.location.reload()};h.getSecondPassword(function(){try{if(F){for(var aX in I){var aZ=I[aX];if(aZ.priv){aZ.priv=h.encrypt(h.decryptPK(aZ.priv),d+al,aU);if(!aZ.priv){throw"addr.priv is null"}}}s.pbkdf2_iterations=aU;w=ae(d+al,aU)}Q=2;P=aU;h.backupWallet("update",function(){aW()},function(){aV(aY)})}catch(aY){aV(aY)}},function(aX){aV(aX)})};this.setDoubleEncryption=function(aW,aU,aY){var aV=function(aZ){console.log("Panic "+aZ);window.location.reload()};try{if(F==aW){return}if(aW){h.getSecondPassword(function(){try{F=true;al=aU;for(var aZ in I){var a1=I[aZ];if(a1.priv){a1.priv=i(B58.decode(a1.priv));if(!a1.priv){throw"addr.priv is null"}}}w=ae(d+al,s.pbkdf2_iterations);al=null;h.getSecondPassword(function(){try{h.checkAllKeys();h.backupWallet("update",function(){aY()},function(){aV(a2)})}catch(a2){aV(a2)}},function(a2){aV(a2)})}catch(a0){aV(a0)}},function(aZ){aV(aZ)})}else{h.getSecondPassword(function(){try{for(var aZ in I){var a1=I[aZ];if(a1.priv){a1.priv=h.decryptPK(a1.priv);if(!a1.priv){throw"addr.priv is null"}}}F=false;al=null;h.checkAllKeys();h.backupWallet("update",function(){aY()},function(){aV(a0)})}catch(a0){aV(a0)}},function(aZ){aV(aZ)})}}catch(aX){aV(aX)}};this.unArchiveAddr=function(aU){var aU=I[aU];if(aU.tag==2){aU.tag=null;c();ai("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Unarchive This Address")}};this.archiveAddr=function(aU){if(h.getActiveAddresses().length<=1){h.makeNotice("error","add-error","You must leave at least one active address");return}var aU=I[aU];if(aU.tag==null||aU.tag==0){aU.tag=2;c();ai("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Archive This Address")}};this.addWatchOnlyAddress=function(aU){return aQ(aU)};this.addPrivateKey=function(aU,aW){if(ak()){return false}if(aU==null){throw"Cannot add null key."}if(aW==null){aW={}}var aZ=aW.compressed?aU.getBitcoinAddressCompressed().toString():aU.getBitcoinAddress().toString();var aY=i(aU.priv);if(aY==null){throw"Error Encoding key"}var aV=new Bitcoin.ECKey(h.decodePK(aY));if(aZ!=aV.getBitcoinAddress().toString()&&aZ!=aV.getBitcoinAddressCompressed().toString()){throw"Decoded Key address does not match generated address"}if(aQ(aZ,aY)){I[aZ].tag=1;I[aZ].created_time=aW.created_time?aW.created_time:0;I[aZ].created_device_name=aW.app_name?aW.app_name:APP_NAME;I[aZ].created_device_version=aW.app_version?aW.app_version:APP_VERSION;if(I[aZ].priv!=aY){throw"Address priv does not match encoded"}try{ws.send('{"op":"addr_sub", "addr":"'+aZ+'"}')}catch(aX){}}else{throw"Unable to add generated bitcoin address."}return aZ};this._seed=function(aW){rng_seed_time();if(aH||aW){var aU=Crypto.util.bytesToWords(Crypto.SHA256(aH?aH:aW,{asBytes:true}));for(var aV in aU){rng_seed_int(aU[aV])}}if(!aa){aa=$("body").data("extra-seed")}if(aa){var aU=Crypto.util.bytesToWords(Crypto.util.hexToBytes(aa));for(var aV in aU){rng_seed_int(aU[aV])}}};this.generateNewKey=function(aV){h._seed(aV);var aU=new Bitcoin.ECKey(false);if(h.addPrivateKey(aU)){return aU}};this.setLoadingText=function(aU){$(".loading-text").text(aU)};function L(){try{$(".popover").remove()}catch(aU){}}$(window).resize(function(){$(".modal:visible").center();L()});function aP(aV,aU){aV.click(function(){z(aU.txIndex,aU.result)});aV.find(".show-note").mouseover(function(){var aW=aU.note?aU.note:b[aU.hash];aJ(this,aW,aU.hash)});aV.find(".add-note").mouseover(function(){m(this,aU.hash)});return aV}function t(aV,a1){var aU=0;for(var aX=0;aX<aV.inputs.length;++aX){var aW=aV.inputs[aX].prev_out;if(!aW||!aW.addr){continue}var a0=I[aW.addr];if(a0){var aZ=parseInt(aW.value);aU-=aZ;if(a1){S+=aZ;a0.balance-=aZ}}}for(var aY=0;aY<aV.out.length;++aY){var aW=aV.out[aY];if(!aW||!aW.addr){continue}var a0=I[aW.addr];if(a0){var aZ=parseInt(aW.value);aU+=aZ;if(a1){at+=aZ;a0.balance+=aZ}}}return aU}function ah(){return Crypto.util.bytesToHex(Crypto.SHA256(aj,{asBytes:true}))}function y(aU){var aV=null;aU.onmessage=function(a2){try{var aZ=$.parseJSON(a2.data);if(aZ.op=="on_change"){var a3=ah();var a1=aZ.checksum;console.log("On change old "+a3+" ==  new "+a1);if(aV!=a1&&a3!=a1){aV=a1;J()}}else{if(aZ.op=="utx"){var a0=TransactionFromJSON(aZ.x);for(var a5 in E){if(E[a5].txIndex==a0.txIndex){return}}var a7=t(a0,true);if(h.getHTML5Notifications()){h.showNotification({title:a7>0?"Payment Received":"Payment Sent",body:"Transaction Value "+formatBTC(a7),iconUrl:resource+"cube48.png"})}a0.result=a7;ay+=a7;K++;a0.setConfirmations(0);playSound("beep");if(ar==0&&aw==0){E.unshift(a0);var a4=false;if(E.length>50){E.pop();a4=true}}var aX=V();if("my-transactions"==aX){if(ar==0&&aw==0){$("#no-transactions").hide();if(s.tx_display==0){var aW=$("#transactions-compact").show();aP($(C(a0,I,g)),a0).prependTo(aW.find("tbody")).find("div").hide().slideDown("slow");if(a4){aW.find("tbody tr:last-child").remove()}}else{var aW=$("#transactions-detailed").show();aW.prepend(a0.getHTML(I,g));if(a4){aW.find("div:last-child").remove()}setupSymbolToggle()}}}else{c()}}else{if(aZ.op=="block"){for(var aY=0;aY<aZ.x.txIndexes.length;++aY){for(var a6=0;a6<E.length;++a6){if(E[a6].txIndex==aZ.x.txIndexes[aY]){if(E[a6].blockHeight==null||E[a6].blockHeight==0){E[a6].blockHeight=aZ.x.height;break}}}}ax(BlockFromJSON(aZ.x));W()}}}}catch(a2){console.log(a2);console.log(a2.data)}};aU.onopen=function(){au("ok");var aZ='{"op":"blocks_sub"}';if(M!=null){aZ+='{"op":"wallet_sub","guid":"'+M+'"}'}try{var aX=h.getActiveAddresses();for(var aW in aX){aZ+='{"op":"addr_sub", "addr":"'+aX[aW]+'"}'}}catch(aY){alert(aY)}aU.send(aZ)};aU.onclose=function(){au("error")}}var aO="ok";function au(aV){var aU=$("#logout");if(aV=="loading_start"){aU.attr("src",resource+"logout-orange.png");return}else{if(aV!="loading_stop"){aO=aV}}if(aO=="ok"){aU.attr("src",resource+"logout.png")}else{if(aO=="error"){aU.attr("src",resource+"logout-red.png")}}}this.showNotification=function(aU){try{if(window.webkitNotifications&&navigator.userAgent.indexOf("Chrome")>-1){if(webkitNotifications.checkPermission()==0){webkitNotifications.createNotification(aU.iconUrl,aU.title,aU.body).show()}}else{if(window.Notification){if(Notification.permissionLevel()=="granted"){new Notification(aU.title,aU).show()}}}}catch(aV){}};this.makeNotice=function(aV,aY,aX,aW){if(aX==null||aX.length==0){return}console.log(aX);if(aW==null){aW=5000}var aU=$('<div class="alert alert-block alert-'+aV+'"></div>');aU.text(""+aX);if($("#"+aY).length>0){aU.attr("id",aY);return}$("#notices").append(aU).hide().fadeIn(200);if(aW>0){(function(){var aZ=aU;setTimeout(function(){aZ.fadeOut(250,function(){$(this).remove()})},aW)})()}};this.pkBytesToSipa=function(aU,aY){var aV=new Bitcoin.ECKey(aU);while(aU.length<32){aU.unshift(0)}aU.unshift(128);if(aV.getBitcoinAddress().toString()==aY){}else{if(aV.getBitcoinAddressCompressed().toString()==aY){aU.push(1)}else{throw"Private Key does not match bitcoin address"+aY}}var aW=Crypto.SHA256(Crypto.SHA256(aU,{asBytes:true}),{asBytes:true});aU=aU.concat(aW.slice(0,4));var aX=B58.encode(aU);return aX};function aE(aU){return aU}function av(aU){return h.decryptPK(aU)}function ac(aU){var aV=h.decodePK(aU);return Crypto.util.bytesToBase64(aV)}function k(aU){var aV=h.decodePK(aU);return Crypto.util.bytesToHex(aV)}this.base58ToSipa=function(aU,aV){return h.pkBytesToSipa(h.decodePK(aU),aV)};this.makeWalletJSON=function(aU){return h.makeCustomWalletJSON(aU,M,d)};this.makeCustomWalletJSON=function(aZ,aV,a1){var aY=aE;if(aZ=="base64"){aY=ac}else{if(aZ=="hex"){aY=k}else{if(aZ=="sipa"){aY=h.base58ToSipa}else{if(aZ=="base58"){aY=av}}}}var aU='{\n	"guid" : "'+aV+'",\n	"sharedKey" : "'+a1+'",\n';if(F&&w!=null&&aY==aE){aU+='	"double_encryption" : '+F+',\n	"dpasswordhash" : "'+w+'",\n'}if(s){aU+='	"options" : '+JSON.stringify(s)+",\n"}aU+='	"keys" : [\n';for(var aX in I){var a0=$.extend({},I[aX]);if(a0.tag==1){delete a0.tag}if(a0.priv!=null){a0.priv=aY(a0.priv,a0.addr)}for(var aW in a0){if(a0[aW]===null||a0[aW]===undefined){delete a0[aW]}}delete a0.balance;aU+=JSON.stringify(a0)+",\n";atLeastOne=true}if(atLeastOne){aU=aU.substring(0,aU.length-2)}aU+="\n	]";if(aD(g)>0){aU+=',\n	"address_book" : [\n';for(var aX in g){aU+='	{"addr" : "'+aX+'",\n';aU+='	 "label" : "'+g[aX]+'"},\n'}aU=aU.substring(0,aU.length-2);aU+="\n	]"}if(aD(b)>0){aU+=',\n	"tx_notes" : '+JSON.stringify(b)}aU+="\n}";return aU};this.get_history=function(aV,aU){BlockchainAPI.get_history(function(aW){H(aW,false);c();if(aV){aV()}},function(){if(aU){aU()}},ar,aw)};this.deleteAddressBook=function(aU){delete g[aU];ai();$("#send-coins").find(".tab-pane").trigger("show",true)};function u(aU){$("#send-coins").find(".tab-pane.active").trigger("show",aU);if(aU){BlockchainAPI.get_ticker();$(".send").prop("disabled",false)}}function l(aU,aV,aZ){var aY=aU.val();aU.empty();for(var aX in I){var a0=I[aX];if(!a0||a0.tag==2){continue}var aW=a0.label;if(!aW){aW=a0.addr.substring(0,15)+"..."}if(aV||a0.balance>0){aU.prepend('<option value="'+a0.addr+'">'+aW+" - "+formatBTC(a0.balance)+"</option>")}}aU.prepend('<option value="any" selected>Any Address</option>');if(!aZ&&aY){aU.val(aY)}}function r(aW,aX){l(aW.find('select[name="from"]'),false,aX);l(aW.find('select[name="change"]'),true,aX);aW.find('select[name="change"]').prepend('<option value="new">New Address</option>');aW.find(".local-symbol").text(symbol_local.symbol);aW.find(".btc-symbol").text(symbol_btc.symbol);if(aX){aW.find("input").val("");aW.find(".send-value-usd").text(formatSymbol(0,symbol_local)).val("");aW.find(".amount-needed").text(0)}var aV=aW.find(".recipient-container");if(aX){var aZ=aV.find(".recipient:first-child").clone();aV.empty().append(aZ)}function aU(){var a0=BigInteger.ZERO;aW.find('input[name="send-value"]').each(function(){a0=a0.add(precisionToSatoshiBN($(this).val()))});return a0}function aY(a0){a0.find('input[name="send-to-address"]').typeahead({source:aA()}).next().click(function(){var a1=$(this).prev();h.scanQRCode(function(a2){console.log(a2);try{new Bitcoin.Address(a2);a1.val(a2)}catch(a3){h.handleURI(a2,a0)}},function(a2){h.makeNotice("error","misc-error",a2)})});a0.find('input[name="send-value"]').unbind().bind("keyup change",function(a1){if(a1.keyCode=="9"){return}aW.find(".amount-needed").text(formatBTC(aU().toString()));a0.find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});a0.find(".send-value-usd").text(formatSymbol(0,symbol_local)).unbind().bind("keyup change",function(a1){if(a1.keyCode=="9"){return}a0.find('input[name="send-value"]').val(formatSatoshi(parseFloat($(this).val())*symbol_local.conversion,sShift(symbol_btc),true))})}aV.find(".recipient").each(function(){aY($(this))});aW.find(".remove-recipient").unbind().click(function(){var a0=aV.find(".recipient").length;if(a0>1){if(a0==2){$(this).hide(200)}aV.find(".recipient:last-child").remove()}});aW.find(".add-recipient").unbind().click(function(){var a0=aV.find(".recipient:first-child").clone();a0.appendTo(aV);aY(a0);aW.find(".remove-recipient").show(200)})}this.getAllAddresses=function(){var aV=[];for(var aU in I){aV.push(aU)}return aV};this.getPreferredAddress=function(){var aV=null;for(var aU in I){var aW=I[aU];if(aV==null){aV=aW}if(aW.priv!=null){if(aV==null){aV=aW}if(aW.tag==null||aW.tag==0){aV=aW;break}}}return aV.addr};function aR(){var aU=$("#restore-backup-modal");aU.modal({keyboard:true,backdrop:"static",show:true});aU.find(".btn.btn-secondary").unbind().click(function(){aU.modal("hide")})}this.scanQRCode=function(aW,aU){var aV=$("#qr-code-reader-modal");aV.modal({keyboard:false,backdrop:"static",show:true});loadScript("wallet/qr.code.reader",function(){QRCodeReader.init(aV,function(aX){aV.modal("hide");aW(aX)},function(aX){aV.modal("hide");aU(aX)})},aU);aV.find(".btn.btn-secondary").unbind().click(function(){QRCodeReader.stop();aV.modal("hide");aU()})};this.getActiveAddresses=function(){var aW=[];for(var aU in I){var aV=I[aU];if(aV.tag!=2){aW.push(aV.addr)}}return aW};this.getArchivedAddresses=function(){var aW=[];for(var aU in I){var aV=I[aU];if(aV.tag==2){aW.push(aV.addr)}}return aW};function ax(aX){if(aX!=null){aF=aX;for(var aV in E){var aU=E[aV];if(aU.blockHeight!=null&&aU.blockHeight>0){var aW=aF.height-aU.blockHeight+1;if(aW<=100){aU.setConfirmations(aF.height-aU.blockHeight+1)}else{aU.setConfirmations(null)}}else{aU.setConfirmations(0)}}}}function z(aV,aU){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Transaction Summary",description:"",src:root+"tx-summary/"+aV+"?result="+aU+"&guid="+M})})}this.deleteNote=function(aU){delete b[aU];c();ai()};function m(aU,aV){(function(aX,aZ){aX=$(aX);if(!aX.data("popover")){aX.popover({title:'Add Note <span style="float:right"><i class="icon-remove-sign"></i></span>',trigger:"manual",content:'<textarea style="width:97%;height:50px;margin-top:2px" placeholder="Enter the note here..."></textarea><div style="text-align:right"><button class="btn btn-small">Save</button></div>'})}else{if(aX.data("popover").tip().is(":visible")){return}}aX.popover("show");aX.mouseleave(function(){if(!aX.__timeout){aX.__timeout=setTimeout(function(){aX.popover("hide")},250)}});function aW(){if(aX.__timeout){clearTimeout(aX.__timeout);aX.__timeout=null}}var aY=aX.data("popover").tip().mouseenter(aW);aY.find("textarea").focus(aW);aY.mouseleave(function(){aX.__timeout=setTimeout(function(){aX.popover("hide")},250)});aY.find("i").unbind().click(function(){aX.popover("hide")});aY.find("button").click(function(){var a0=stripHTML(aY.find("textarea").val()).replace(/'/g,"").replace(/"/g,"");if(a0.length>0){b[aZ]=a0;ai()}c()})})(aU,aV)}function aJ(aU,aV,aW){(function(aX,aY,a0){aX=$(aX);if(!aX.data("popover")){var a1="Note";if(b[a0]){a1+=' <span style="float:right"><img src="'+resource+'delete.png" /></span>'}$(aX).popover({title:a1,trigger:"manual",content:$("<div/>").html(aY).text()})}else{if(aX.data("popover").tip().is(":visible")){return}}aX.popover("show");aX.mouseleave(function(){if(!aX.__timeout){aX.__timeout=setTimeout(function(){aX.popover("hide")},250)}});var aZ=aX.data("popover").tip().mouseenter(function(){if(aX.__timeout){clearTimeout(aX.__timeout);aX.__timeout=null}});aZ.find("img").unbind().click(function(){h.deleteNote(a0)});aZ.mouseleave(function(){aX.__timeout=setTimeout(function(){aX.popover("hide")},250)})})(aU,aV,aW)}function C(aX,a2,aZ){var a3=aX.result;var aY='<tr class="pointer" id="tx-'+aX.txIndex+'"><td class="hidden-phone" style="width:365px"><div><ul style="margin-left:0px;" class="short-addr">';var aV=true;if(a3>=0){for(var aW=0;aW<aX.inputs.length;++aW){var aU=aX.inputs[aW].prev_out;if(!aU||!aU.addr){aV=false;aY+='<span class="label">Newly Generated Coins</span>'}else{var a0=a2[aU.addr];if(a0){continue}aV=false;aY+=formatOutput(aU,a2,aZ)}}}else{if(a3<0){for(var aW=0;aW<aX.out.length;++aW){var aU=aX.out[aW];var a0=a2[aU.addr];if(a0&&aU.type==0){continue}aV=false;aY+=formatOutput(aU,a2,aZ)}}}if(aV){aY+='<span class="label">Moved Between Wallet</info>'}aY+="</ul></div></td><td><div>";var a1=aX.note?aX.note:b[aX.hash];if(a1){aY+='<img src="'+resource+'note.png" class="show-note"> '}else{aY+='<img src="'+resource+'note_grey.png" class="add-note"> '}if(aX.time>0){aY+=dateToString(new Date(aX.time*1000))}if(aX.confirmations==0){aY+=' <span class="label label-important hidden-phone">Unconfirmed Transaction!</span> '}else{if(aX.confirmations>0){aY+=' <span class="label label-info hidden-phone">'+aX.confirmations+" Confirmations</span> "}}aY+="</div></td>";if(a3>0){aY+='<td style="color:green"><div>'+formatMoney(a3,true)+"</div></td>"}else{if(a3<0){aY+='<td style="color:red"><div>'+formatMoney(a3,true)+"</div></td>"}else{aY+="<td><div>"+formatMoney(a3,true)+"</div></td>"}}if(aX.balance==null){aY+="<td></td></tr>"}else{aY+='<td class="hidden-phone"><div>'+formatMoney(aX.balance)+"</div></td></tr>"}return aY}function V(){L();if(ay==null){$("#balance").html("Loading...")}else{$("#balance").html(formatSymbol(ay,symbol,true));$("#balance2").html(formatSymbol(ay,(symbol===symbol_local)?symbol_btc:symbol_local),true)}return j.attr("id")}function c(aU){var aV=V();if("send-coins"==aV){u(aU)}else{if("home-intro"==aV){f(aU)}else{if("receive-coins"==aV){aT(aU)}else{if("my-transactions"==aV){W(aU)}}}}}function f(aU){$("#summary-n-tx").html(K);$("#summary-received").html(formatMoney(at,true));$("#summary-sent").html(formatMoney(S,true));$("#summary-balance").html(formatMoney(ay,symbol));var aW=h.getPreferredAddress();$(".paper-wallet-btn").unbind().click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showModal()})});if(h.isWatchOnly(aW)){$(".no-watch-only").hide()}else{$(".no-watch-only").show();var aV=$("#my-primary-address");if(aV.text()!=aW){aV.text(aW);loadScript("wallet/jquery.qrcode",function(){$("#my-primary-addres-qr-code").empty().qrcode({width:125,height:125,text:aW})})}}}function T(){var aU=$("#export-warning").show();var aV=$("#import-export-content").hide();$("#show-import-export").unbind().click(function(){h.getMainPassword(function(){aU.hide();loadScript("wallet/import-export",function(){ImportExport.init(aV,function(){aV.show()},function(){af($("#home-intro"))})},function(aW){h.makeNotice("error","misc-error",aW);af($("#home-intro"))})},function(){af($("#home-intro"))})})}function W(){var aV=null;var aX=0;if(aV!=null){clearInterval(aV);aV=null}var aU;if(s.tx_display==0){$("#transactions-detailed").hide();aU=$("#transactions-compact").show().find("tbody").empty()}else{$("#transactions-compact").hide();aU=$("#transactions-detailed").empty().show()}if(E.length==0){$("#transactions-detailed, #transactions-compact").hide();$("#no-transactions").show();return}else{$("#no-transactions").hide()}var aW=function(){for(var a1=aX;a1<E.length&&a1<(aX+10);++a1){var a0=E[a1];if(s.tx_display==0){aU.append(aP($(C(a0,I,g)),a0))}else{aU.append(a0.getHTML(I,g))}}aX+=10;if(aX<E.length){aV=setTimeout(aW,15)}else{setupSymbolToggle();L();var aZ=$(".pagination ul").empty();if(aw==0&&E.length<50){aZ.hide();return}else{aZ.show()}var aY=Math.ceil(aS/50);var a2=" disabled";if(aw>0){a2=""}aZ.append($('<li class="prev'+a2+'"><a>&larr; Previous</a></li>').click(function(){h.setPage(aw-1)}));for(var a1=0;a1<aY&&a1<=10;++a1){(function(a3){var a4="";if(aw==a3){a4=' class="active"'}aZ.append($("<li"+a4+'><a class="hidden-phone">'+a3+"</a></li>").click(function(){h.setPage(a3)}))})(a1)}var a2=" disabled";if(aw<aY){a2=""}aZ.append($('<li class="next'+a2+'"><a>Next &rarr;</a></li>').click(function(){h.setPage(aw+1)}))}};aW()}this.setPage=function(aU){aw=aU;scroll(0,0);h.get_history()};function v(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Export History",description:"",src:root+"export-history?active="+h.getActiveAddresses().join("|")+"&archived="+h.getArchivedAddresses().join("|")})})}function H(aX,aW){if(!aW&&aX.mixer_fee){x=aX.mixer_fee}if(aX.disable_mixer){$("#shared-addresses,#send-shared").hide()}E.length=0;if(aX.wallet==null){at=0;S=0;ay=0;K=0;aS=0;return}at=aX.wallet.total_received;S=aX.wallet.total_sent;ay=aX.wallet.final_balance;K=aX.wallet.n_tx;aS=aX.wallet.n_tx_filtered;for(var aV=0;aV<aX.addresses.length;++aV){if(I[aX.addresses[aV].address]){I[aX.addresses[aV].address].balance=aX.addresses[aV].final_balance}}for(var aV=0;aV<aX.txs.length;++aV){var aU=TransactionFromJSON(aX.txs[aV]);aU.result=t(aU,false);E.push(aU)}if(aX.info){$("#nodes-connected").html(aX.info.nconnected);if(aX.info.latest_block){ax(aX.info.latest_block)}if(aX.info.symbol_local){setLocalSymbol(aX.info.symbol_local)}if(aX.info.symbol_btc){setBTCSymbol(aX.info.symbol_btc)}}}this.handleURI=function(aV,aU){loadScript("wallet/jsuri-1.1.1",function(){try{var aX=new Uri(aV);var aW=new Bitcoin.Address(aX.host());aU.find('input[name="send-to-address"]').val(aW.toString());var aY=parseFloat(aX.getQueryParamValue("amount"));if(aY>0&&!isNaN(aY)){aU.find('input[name="send-value"]').val(aY)}}catch(aZ){console.log(aZ);h.makeNotice("error","error","Invalid Bitcoin Address or URI")}},function(){h.makeNotice("error","error","Invalid Bitcoin Address or URI")})};function aL(){J();U=setTimeout(h.logout,h.getLogoutTime());for(var aW in Z){Z[aW]("did_decrypt")}MyStore.get("multiaddr",function(aY){if(aY!=null){H($.parseJSON(aY),true);c()}});h.get_history();$("#initial_error,#initial_success").remove();var aX=decodeURIComponent(window.location.hash.replace("#",""));if(aX.indexOf("bitcoin:")==0){var aU=$("#send-coins");af(aU);var aV=aU.find(".tab-pane.active").find(".recipient").first();h.handleURI(aX,aV)}else{af($("#home-intro"))}window.location.hash=""}function J(aX,aU){for(var aV in I){var aY=I[aV];if(aY.tag==1){alert("Warning! wallet data may have changed but cannot sync as you have un-saved keys");return}}console.log("Get wallet with checksum "+az);var aW={method:"wallet.aes.json",format:"json"};if(az&&az.length>0){aW.checksum=az}h.securePost("wallet",aW,function(aZ){if(!aZ.payload||aZ.payload=="Not modified"){if(aX){aX()}return}console.log("Wallet data modified");h.setEncryptedWalletData(aZ.payload);ab(function(){h.get_history();c();if(aX){aX()}},function(){if(aU){aU()}})},function(aZ){if(aU){aU()}})}function ab(aV,aU){if(aj==null||aj.length==0){aU("No Wallet Data To Decrypt");return}h.decryptWallet(aj,aH,function(a0,aY){try{d=a0.sharedKey;if(!d||d.length==0||d.length!=36){throw"Shared Key is invalid"}if(aY){Q=aY.version;P=aY.pbkdf2_iterations}if(a0.double_encryption&&a0.dpasswordhash){F=a0.double_encryption;w=a0.dpasswordhash}if(a0.options){$.extend(s,a0.options)}I={};for(var aX=0;aX<a0.keys.length;++aX){var aW=a0.keys[aX];if(aW.addr==null||aW.addr.length==0||aW.addr=="undefined"){h.makeNotice("error","null-error","Your wallet contains an undefined address. This is a sign of possible corruption, please double check all your BTC is accounted for. Backup your wallet to remove this error.",15000);continue}if(aW.tag==1){aW.tag=null}I[aW.addr]=aW}g={};if(a0.address_book){for(var aX=0;aX<a0.address_book.length;++aX){h.addAddressBookEntry(a0.address_book[aX].addr,a0.address_book[aX].label)}}if(a0.tx_notes){b=a0.tx_notes}if(az==null||az.length==0){az=ah()}e();aV()}catch(aZ){aU(aZ)}},aU)}this.getPassword=function(aZ,a0,aX){if(!aZ.is(":visible")){aZ.trigger("hidden");aZ.unbind()}aZ.modal({keyboard:false,backdrop:"static",show:true});aZ.center();var aY=aZ.find('input[name="password"]');var a2=aY,aU=false,a1=false;aZ.find(".vkeyboard li").unbind().click(function(){var a5=$(this),a4=a5.html();if(a5.hasClass("left-shift")||a5.hasClass("right-shift")){$(".letter").toggleClass("uppercase");$(".symbol span").toggle();aU=(aU===true)?false:true;a1=false;return false}if(a5.hasClass("capslock")){$(".letter").toggleClass("uppercase");a1=true;return false}if(a5.hasClass("delete")){var a3=a2.val();a2.val(a3.substr(0,a3.length-1));return false}if(a5.hasClass("symbol")){a4=$("span:visible",a5).html()}if(a5.hasClass("space")){a4=" "}if(a5.hasClass("tab")){a4="\t"}if(a5.hasClass("return")){a4="\n"}if(a5.hasClass("uppercase")){a4=a4.toUpperCase()}if(aU===true){$(".symbol span").toggle();if(a1===false){$(".letter").toggleClass("uppercase")}aU=false}a2.val(a2.val()+a4)});aY.keypress(function(a3){if(a3.keyCode==13){a3.preventDefault();aZ.find(".btn.btn-primary").click()}});aY.val("");var aV=aZ.find(".btn.btn-primary");aV.click(function(){if(a0){aX=null;var a3=a0;a0=null;setTimeout(function(){aZ.modal("hide");a3(aY.val())},10)}else{aZ.modal("hide")}});var aW=aZ.find(".btn.btn-secondary");aW.click(function(){if(aX){var a3=aX;aX=null;a0=null;setTimeout(function(){aZ.modal("hide");try{a3()}catch(a4){h.makeNotice("error","misc-error",a4)}},10)}else{aZ.modal("hide")}});aZ.on("hidden",function(){aY.unbind();aW.unbind();aV.unbind();aZ.unbind();if(aX){var a3=aX;aX=null;a0=null;setTimeout(function(){try{a3()}catch(a4){h.makeNotice("error","misc-error",a4)}},10)}})};this.makePairingQRCode=function(aV,aU){h.getMainPassword(function(){loadScript("wallet/jquery.qrcode",function(){try{if(aU==1){h.securePost("wallet",{method:"pairing-encryption-password"},function(aX){aV($("<div></div>").qrcode({width:300,height:300,text:"1|"+M+"|"+h.encrypt(d+"|"+Crypto.util.bytesToHex(UTF8.stringToBytes(aH)),aX,h.getDefaultPbkdf2Iterations())}))},function(aX){h.makeNotice("error","misc-error",aX)})}else{if(aU==0){aV($("<div></div>").qrcode({width:300,height:300,text:M+"|"+d+"|"+aH}))}}}catch(aW){h.makeNotice("error","misc-error",aW)}})},function(){h.logout()})};this.getMainPassword=function(aV,aU){if(B>new Date().getTime()-N){return aV(aH)}h.getPassword($("#main-password-modal"),function(aW){if(aH==aW){B=new Date().getTime();if(aV){try{aV(aH)}catch(aX){h.makeNotice("error","misc-error",aX)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aU){try{aU()}catch(aX){h.makeNotice("error","misc-error",aX)}}}},aU)};this.getSecondPassword=function(aW,aU){if(!F||al!=null){if(aW){try{aW(al)}catch(aV){h.makeNotice("error","misc-error",aV)}}return}h.getPassword($("#second-password-modal"),function(aX){try{if(aI(aX)){if(aW){try{aW(aX)}catch(aY){console.log(aY);h.makeNotice("error","misc-error",aY)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aU){try{aU()}catch(aY){h.makeNotice("error","misc-error",aY)}}}}catch(aY){if(aU){try{aU()}catch(aY){h.makeNotice("error","misc-error",aY)}}}},aU)};function a(){if(A){return}var aU=$("#restore-password");aH=aU.val();aU.val("");B=new Date().getTime();if(aj==null||aj.length==0){h.setLoadingText("Validating Authentication key");var aV=$.trim($(".auth-"+q).find(".code").val());if(aV.length==0||aV.length>255){h.makeNotice("error","misc-error","You must enter a Two Factor Authentication code");return false}$.ajax({type:"POST",url:root+"wallet",data:{guid:M,payload:aV,length:aV.length,method:"get-wallet",format:"plain"},success:function(aW){try{if(aW==null||aW.length==0){h.makeNotice("error","misc-error","Server Return Empty Wallet Data");return}if(aW!="Not modified"){h.setEncryptedWalletData(aW)}$(".auth-"+q).hide();$(".auth-0").show();ab(function(){n();aL()},function(aY){h.makeNotice("error","misc-error",aY)})}catch(aX){h.makeNotice("error","misc-error",aX)}},error:function(aW){h.makeNotice("error","misc-error",aW.responseText)}})}else{ab(function(){n();aL()},function(aW){h.makeNotice("error","misc-error",aW)})}}function O(){$("#not-synced-warning-modal").modal("show").find(".btn.btn-danger").unbind().click(function(){$(this).modal("hide");aq=true;c()})}function e(){au("error");webSocketConnect(y);A=true;$("#tech-faq").hide();$("#intro-text").hide();$("#large-summary").show()}this.quickSendNoUI=function(aW,aV,aU){loadScript("wallet/signer",function(){h.getSecondPassword(function(){try{var aY=initNewTx();aY.from_addresses=h.getActiveAddresses();aY.to_addresses.push({address:new Bitcoin.Address(aW),value:Bitcoin.Util.parseValue(aV)});aY.addListener(aU);aY.start()}catch(aX){aU.on_error(aX)}},function(aX){aU.on_error(aX)})})};function G(){h.setLoadingText("Sending email backup");h.securePost("wallet",{method:"email-backup"},function(aU){h.makeNotice("success","backup-success",aU)},function(aU){h.makeNotice("error","misc-error",aU.responseText)})}function ai(aX,aW,aV,aU){if(an){clearInterval(an);an=null}an=setTimeout(function(){h.backupWallet(aX,aW,aV,aU)},3000)}this.backupWallet=function(a0,aZ,aV){if(an){clearInterval(an);an=null}var aU=function(a1){h.makeNotice("error","misc-error","Error Saving Wallet: "+a1,10000);c();if(aV!=null){aV(a1)}else{throw a1}};try{if(a0==null){a0="update"}if(aD(I)==0){return}var aW=h.makeWalletJSON();var aY=h.encryptWallet(aW,aH);if(aY.length==0){throw"Error encrypting the JSON output"}h.decryptWallet(aY,aH,function(a3){try{var a1=az;h.setLoadingText("Saving wallet");h.setEncryptedWalletData(aY);h.securePost("wallet",{length:aY.length,payload:aY,checksum:az,old_checksum:a1,method:a0,format:"plain"},function(a5){for(var a4 in I){var a6=I[a4];if(a6.tag==1){delete a6.tag}}h.makeNotice("success","misc-success",a5);c();if(aZ!=null){aZ()}},function(a5){for(var a4 in I){var a6=I[a4];if(a6.tag==1){O();break}}aU(a5.responseText)})}catch(a2){aU(a2)}})}catch(aX){aU(aX)}};function aM(aU){if(F){if(al==null){throw"Cannot encrypt private key without a password"}return h.encrypt(aU,d+al,h.getSecondPasswordPbkdf2Iterations())}else{return aU}return null}this.isBase58=function(aW,aV){for(var aU=0;aU<aW.length;++aU){if(aW[aU]<0||aW[aU]>58){return false}}return true};this.encrypt=function(aW,aV,aU){return Crypto.AES.encrypt(aW,aV,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aU})};this.encryptWallet=function(aV,aU){if(Q==2){return JSON.stringify({pbkdf2_iterations:h.getMainPasswordPbkdf2Iterations(),version:Q,payload:h.encrypt(aV,aU,h.getMainPasswordPbkdf2Iterations())})}else{if(Q==0){return h.encrypt(aV,aU,h.getDefaultPbkdf2Iterations())}else{throw"Unknown encryption version "+Q}}};this.decryptWallet=function(aV,a1,a2,aY){try{var aU=null;try{var aU=$.parseJSON(aV)}catch(aW){console.log(aW)}var aX=function(){try{var a4=Crypto.AES.decrypt(aU.payload,a1,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aU.pbkdf2_iterations});var a3=$.parseJSON(a4);a2(a3,aU)}catch(a5){aY("Error Decrypting Wallet. Please check your password is correct.")}};if(aU&&aU.payload&&aU.pbkdf2_iterations){if(aU.version!=ap){throw"Wallet version "+aU.version+" not supported"}if(aU.pbkdf2_iterations>100){var a0=$("#decrypting-progress-modal");var aZ=setTimeout(function(){a0.modal({keyboard:false,backdrop:"static",show:true});a0.center()},500);h.decryptWebWorker(aU.payload,a1,aU.pbkdf2_iterations,function(a4){clearTimeout(aZ);a0.modal("hide");try{var a3=$.parseJSON(a4);a2(a3,aU)}catch(a5){aX()}},function(){clearTimeout(aZ);a0.modal("hide");aX()})}else{aX()}}else{h.decrypt(aV,a1,h.getDefaultPbkdf2Iterations(),function(a4){try{var a3=$.parseJSON(a4);try{a2(a3)}catch(a5){console.log(a5)}return true}catch(a5){return false}},function(){aY("Error Decrypting Wallet. Please check your password is correct.")})}}catch(aW){if(aY){aY(aW)}}};this.decryptWebWorker=function(aX,a1,aW,a2,a0){var aU=false;var aZ=function(a3){if(!aU){a0(a3);aU=true}};try{var aV=new Worker(resource+"wallet/signer"+(min?".min.js":".js"));aV.addEventListener("message",function(a4){var a3=a4.data;try{switch(a3.cmd){case"on_decrypt":a2(a3.data);aV.terminate();break;case"on_error":throw a3.e}}catch(a4){aV.terminate();aZ(a4)}},false);aV.addEventListener("error",function(a3){aZ(a3)});aV.postMessage({cmd:"load_resource",path:resource+"wallet/bitcoinjs"+(min?".min.js":".js")});aV.postMessage({cmd:"decrypt",data:aX,password:a1,pbkdf2_iterations:aW})}catch(aY){aZ(aY)}};this.decrypt=function(aY,aX,aV,a0,aW){try{var aU=Crypto.AES.decrypt(aY,aX,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aV});if(aU!=null&&aU.length>0){if(a0(aU)){return aU}}}catch(aZ){console.log(aZ)}if(aV!=10){try{var aU=Crypto.AES.decrypt(aY,aX,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:10});if(aU!=null&&aU.length>0){if(a0(aU)){return aU}}}catch(aZ){console.log(aZ)}}try{var aU=Crypto.AES.decrypt(aY,aX);if(aU!=null&&aU.length>0){if(a0(aU)){return aU}}}catch(aZ){console.log(aZ)}try{var aU=Crypto.AES.decrypt(aY,aX,{mode:new Crypto.mode.OFB(Crypto.pad.iso7816),iterations:1});if(aU!=null&&aU.length>0){if(a0(aU)){return aU}}}catch(aZ){console.log(aZ)}try{var aU=Crypto.AES.decrypt(aY,aX,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:1});if(aU!=null&&aU.length>0){if(a0(aU)){return aU}}}catch(aZ){console.log(aZ)}if(aW){aW()}return null};this.handleNTPResponse=function(aY,aZ){var aW=(new Date()).getTime();if(aY.clientTimeDiff&&aY.serverTime){var aU=aW-aY.serverTime;var aV=(aY.clientTimeDiff-aW+aZ-aU)/2;var aX=(aU-aV)/2;if(Y){aK=(aK+aX)/2}else{aK=aX;Y=true;MyStore.put("server_time_offset",""+aK)}console.log("Server Time offset "+aK+"ms - This offset "+aX)}};this.setGUID=function(aW,aU){console.log("Set GUID "+aW);if(A){throw"Cannot Set GUID Once Initialized"}h.setLoadingText("Changing Wallet Identifier");$("#initial_error,#initial_success").remove();var aV=$("#restore-wallet-continue");aV.prop("disabled",true);var aY=(new Date()).getTime();var aX={format:"json",resend_code:aU,ct:aY};if(az){aX.checksum=az}$.ajax({type:"GET",dataType:"json",url:root+"wallet/"+aW,data:aX,timeout:10000,success:function(aZ){h.handleNTPResponse(aZ,aY);aV.prop("disabled",false);if(!aZ.guid){h.makeNotice("error","misc-error","Server returned null guid.");return}$(".auth-"+q).hide();aa=aZ.extra_seed;M=aZ.guid;q=aZ.auth_type;aN=aZ.real_auth_type;if(aZ.payload&&aZ.payload.length>0&&aZ.payload!="Not modified"){h.setEncryptedWalletData(aZ.payload)}war_checksum=aZ.war_checksum;setLocalSymbol(aZ.symbol_local);$("#restore-guid").val(M);$(".auth-"+q).show();if(aZ.initial_error){h.makeNotice("error","misc-error",aZ.initial_error)}if(aZ.initial_success){h.makeNotice("success","misc-success",aZ.initial_success)}MyStore.get("guid",function(a0){if(a0!=M){MyStore.remove("guid");MyStore.remove("payload");MyStore.remove("multiaddr");if(M!=D){MyStore.put("guid",M)}}});if(aZ.language&&X!=aZ.language){h.setLanguage(aZ.language)}},error:function(aZ){console.log("Set GUID Success");aV.prop("disabled",false);MyStore.get("guid",function(a0){if(a0==aW&&aj){h.makeNotice("error","misc-error","Error Contacting Server. Using Local Wallet Cache.");M=a0;az=ah();q=0;$("#restore-guid").val(M);$(".auth-"+q).show();return}try{var a2=$.parseJSON(aZ.responseText);if(a2.initial_error){h.makeNotice("error","misc-error",a2.initial_error);return}}catch(a1){}if(aZ.responseText){h.makeNotice("error","misc-error",aZ.responseText)}else{h.makeNotice("error","misc-error","Error changing wallet identifier")}})}})};function i(aU){var aV=B58.encode(aU);return aM(aV)}this.decryptPK=function(aU){if(F){if(al==null){throw"Cannot decrypt private key without a password"}return h.decrypt(aU,d+al,h.getSecondPasswordPbkdf2Iterations(),h.isBase58)}else{return aU}return null};this.decodePK=function(aV){if(!aV){throw"null PK passed to decodePK"}var aU=h.decryptPK(aV);if(aU!=null){return B58.decode(aU)}return null};this.signmessage=function(aU,aW){var aY=I[aU];if(!aY.priv){throw"Cannot sign a watch only address"}var aX=h.decodePK(aY.priv);var aV=new Bitcoin.ECKey(aX);return Bitcoin.Message.signMessage(aV,aW,aY.addr)};function aI(aV){var aU=Crypto.SHA256(d+aV,{asBytes:true});var aY=ae(aU,h.getSecondPasswordPbkdf2Iterations()-1);if(aY==w){al=aV;return true}if(h.getSecondPasswordPbkdf2Iterations()!=10){var aW=ae(aU,10-1);if(aW==w){al=aV;w=aY;return true}}if(Crypto.util.bytesToHex(aU)==w){al=aV;w=aY;return true}var aX=Crypto.SHA256(aV);if(aX==w){al=aV;w=aY;return true}return false}this.runCompressedCheck=function(){var aU=[];var aW={};for(var aX in I){var a1=I[aX];if(a1.priv!=null){var a0=h.decodePK(a1.priv);var aY=new Bitcoin.ECKey(a0);var aV=aY.getBitcoinAddress().toString();var aZ=aY.getBitcoinAddressCompressed().toString();if(a1.addr!=aV){aW[aV]=a1.priv;aU.push(aV)}if(a1.addr!=aZ){aW[aZ]=a1.priv;aU.push(aZ)}}}if(aU.length==0){alert("to_check length == 0")}BlockchainAPI.get_balances(aU,function(a3){var a4=0;for(var a2 in a3){var a5=a3[a2].final_balance;if(a5>0){alert(formatBTC(a5)+" claimable in address "+a2+" (Import PK : "+h.base58ToSipa(aW[a2],a2)+")")}a4+=a5}alert(formatBTC(a5)+" found in compressed addresses")})};this.checkAllKeys=function(aU){for(var aV in I){var aZ=I[aV];if(aZ.addr==null){throw"Null Address Found in wallet "+aV}if(aZ.addr.toString()==null){throw"Error decoding wallet address "+aZ.addr}if(aZ.priv!=null){var aY=h.decodePK(aZ.priv);var aX=new Bitcoin.ECKey(aY);var aW=aX.getBitcoinAddress().toString();if(aW!=aZ.addr&&aX.getBitcoinAddressCompressed().toString()!=aZ.addr){throw"Private key does not match bitcoin address "+aZ.addr+" != "+aW}if(aU){aZ.priv=i(aY)}}}h.makeNotice("success","wallet-success","Wallet verified.")};this.setMainPassword=function(aU){h.getMainPassword(function(){aH=aU;h.backupWallet("update",function(){h.logout()},function(){h.logout()})})};function af(aU){if(aU===j){return}if(j!=null){if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","")}j.hide()}j=aU;j.show();if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","active")}c(true)}function aD(aW){var aV=0,aU;for(aU in aW){aV++}return aV}function ad(aU){I[aU].priv=null}function ak(){if(aD(I)>=aB){h.makeNotice("error","misc-error","We currently support a maximum of "+aB+" private keys, please remove some unused ones.");return true}return false}function aQ(aW,aU){var aV=I[aW];if(!aV||aV.length==0){I[aW]={addr:aW,priv:aU,balance:0};return true}else{if(!aV.priv&&aU){aV.priv=aU;return true}}return false}function o(){var aW=$("#add-address-book-entry-modal");aW.modal({keyboard:true,backdrop:"static",show:true});var aU=aW.find('input[name="label"]');var aV=aW.find('input[name="address"]');aU.val("");aV.val("");aW.find(".btn.btn-primary").unbind().click(function(){aW.modal("hide");var aY=stripHTML(aU.val());var aX=stripHTML(aV.val());if(aY.length==0||aX.length==0){h.makeNotice("error","misc-error","You must enter an address and label for the address book entry");return false}var a0;try{a0=new Bitcoin.Address(aX);if(a0==null){throw"Null address"}}catch(aZ){h.makeNotice("error","misc-error","Bitcoin address invalid, please make sure you entered it correctly");return false}if(g[aX]!=null){h.makeNotice("error","misc-error","Bitcoin address already exists");return false}h.makeNotice("success","misc-success","Added Address book entry");h.addAddressBookEntry(aX,aY);ai();$("#send-coins").find(".tab-pane").trigger("show",true)});aW.find(".btn.btn-secondary").unbind().click(function(){aW.modal("hide")})}this.logout=function(){if(U){clearTimeout(U)}if(M==D){window.location=root+"wallet/logout"}else{$.ajax({type:"GET",url:root+"wallet/logout",data:{format:"plain"},success:function(aU){window.location.reload()},error:function(){window.location.reload()}})}};function ao(a0){var a2=$("#delete-address-modal");a2.modal({keyboard:true,backdrop:"static",show:true});a2.find(".btn.btn-primary").hide();a2.find(".btn.btn-danger").hide();$("#change-mind").hide();a2.find("#to-delete-address").html(a0.join(" "));a2.find("#delete-balance").empty();var aW=a2.find("#delete-balance");var aU=[];for(var aZ in a0){var a1=a0[aZ];if(I[a1]&&I[a1].priv){aU.push(a0[aZ])}}BlockchainAPI.get_balance(aU,function(a3){a2.find(".btn.btn-primary").show(200);a2.find(".btn.btn-danger").show(200);aW.html("Balance "+formatBTC(a3));if(a3>0){aW.css("color","red")}else{aW.css("color","black")}},function(){a2.find(".btn.btn-primary").show(200);a2.find(".btn.btn-danger").show(200);aW.text("Error Fetching Balance")});var aX=false;var aZ=0;var aV=null;var aY=10;changeMind=function(){$("#change-mind").show();$("#change-mind-time").text(aY-aZ)};a2.find(".btn.btn-primary").unbind().click(function(){changeMind();a2.find(".btn.btn-primary").hide();a2.find(".btn.btn-danger").hide();aV=setInterval(function(){if(aX){return}++aZ;changeMind();if(aZ==aY){$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Private Key Removed From Wallet");for(var a3 in a0){ad(a0[a3])}c();h.backupWallet();clearInterval(aV)}},1000)});a2.find(".btn.btn-danger").unbind().click(function(){changeMind();a2.find(".btn.btn-primary").hide();a2.find(".btn.btn-danger").hide();aV=setInterval(function(){if(aX){return}++aZ;changeMind();if(aZ==aY){try{$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Address & Private Key Removed From Wallet");for(var a3 in a0){h.deleteAddress(a0[a3])}c();h.backupWallet("update",function(){h.get_history()})}finally{clearInterval(aV)}}},1000)});a2.unbind().on("hidden",function(){if(aV){aX=true;clearInterval(aV);aV=null}});a2.find(".btn.btn-secondary").unbind().click(function(){a2.modal("hide")})}function aA(){var aW=[];for(var aU in g){aW.push(g[aU])}for(var aU in I){var aV=I[aU];if(aV.tag!=2&&aV.label){aW.push(aV.label)}}return aW}function R(aU){h.getSecondPassword(function(){var aW=$("#sweep-address-modal");aW.modal("show");BlockchainAPI.get_balance(aU,function(aX){aW.find(".balance").text("Amount: "+formatBTC(aX))},function(){aW.find(".balance").text("Error Fetching Balance")});var aV=aW.find('select[name="change"]');l(aV,true);aW.find(".btn.btn-primary").unbind().click(function(){loadScript("wallet/signer",function(){BlockchainAPI.get_balance(aU,function(aX){var aY=initNewTx();aY.fee=aY.base_fee;aY.to_addresses.push({address:new Bitcoin.Address($.trim(aV.val())),value:BigInteger.valueOf(aX).subtract(aY.fee)});aY.from_addresses=aU;aY.start()},function(){h.makeNotice("error","misc-error","Error Getting Address Balance")})});aW.modal("hide")});aW.find(".btn.btn-secondary").unbind().click(function(){aW.modal("hide")})})}function aC(){try{$(".pop").popover({offset:10,placement:"bottom"})}catch(aU){}}function n(){$("#add-address-book-entry-btn").click(function(){o()});$("#home-intro-btn").click(function(){af($("#home-intro"))});$("#my-transactions-btn").click(function(){af($("#my-transactions"))});$("#send-coins-btn").click(function(){af($("#send-coins"))});$("#import-export-btn").click(function(){af($("#import-export"));T()});$("#chord-diagram").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Address Relationships",description:"",src:root+"taint/"+h.getActiveAddresses().join("|")})})});$("#verify-message").click(function(){loadScript("wallet/address_modal",function(){verifyMessageModal()})});$("#generate-cold-storage").click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showColdStorageModal()},null,true)});$("#group-received").click(function(){loadScript("wallet/taint_grouping",function(){try{loadTaintData()}catch(aU){h.makeNotice("error","misc-error","Unable To Load Taint Grouping Data")}})});$("#my-account-btn").click(function(){af($("#my-account"));var aU=$("#account-settings-warning").show();var aV=$("#my-account-content").hide();$("#show-account-settings").unbind().click(function(){h.getMainPassword(function(){aU.hide();loadScript("wallet/account",function(){AccountSettings.init(aV,function(){aV.show()},function(){af($("#home-intro"))})},function(aW){h.makeNotice("error","misc-error",aW);af($("#home-intro"))})},function(){af($("#home-intro"))})})});$("#enable_archived_checkbox").change(function(){var aU=$(this).is(":checked");$(".archived_checkbox").prop("checked",false);$(".archived_checkbox").prop("disabled",!aU);$("#archived-sweep").prop("disabled",!aU);$("#archived-delete").prop("disabled",!aU)});$("#shared-addresses").on("show",function(){var aU=$(this);loadScript("wallet/shared-addresses",function(){buildSharedTable(aU)})});$("#active-addresses").on("show",function(){var a0=$(this).find("table:first");a0.find("tbody:gt(0)").remove();var aX=a0.find("tbody").empty();for(var aZ in I){var a1=I[aZ];if(a1.tag==2||(a1.tag==1&&!aq)){continue}var aY="";if(a1.tag==1){aY=' <font color="red" class="pop" title="Not Synced" data-content="This is a new address which has not yet been synced with our the server. Do not used this address yet.">(Not Synced)</font>'}else{if(a1.priv==null){aY=' <font color="red" class="pop" title="Watch Only" data-content="Watch Only means there is no private key associated with this bitcoin address. <br /><br /> Unless you have the private key stored elsewhere you do not own the funds at this address and can only observe the transactions.">(Watch Only)</font>'}}var aU="";var aW=a1.addr;if(a1.label!=null){aW=a1.label;aU='<span class="hidden-phone"> - '+a1.addr+"</span>"}var aV=$('<tr><td><div class="short-addr"><a href="'+root+"address/"+a1.addr+'" target="new">'+aW+"</a>"+aU+" "+aY+'<div></td><td><span style="color:green">'+formatMoney(a1.balance,true)+'</span></td>            <td><div class="btn-group pull-right"><a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#"><span class="hidden-phone">Actions </span><span class="caret"></span></a><ul class="dropdown-menu">             <li><a href="#" class="pop act-archive" title="Archive Address" data-content="Click this button to hide the address from the main view. You can restore or delete later by finding it in the Archived addresses tab.">Archive Address</a></li>            <li><a href="#" class="pop act-label" title="Label Address" data-content="Set the label for this address.">Label Address</a></li>            <li><a href="#" class="pop act-qr" title="Show QR Code" data-content="Show a QR Code for this address.">QR Code</a></li>            <li><a href="#" class="pop act-sign" title="Sign Message" data-content="Sign A message with this address.">Sign Message</a></li>            <li><a href="#" class="pop act-request" title="Request Payment" data-content="Click here to create a new QR Code payment request. The QR Code can be scanned using most popular bitcoin software and mobile apps.">Create Payment Request</a></li>            <li><a href="#" class="pop act-pubkey">Show Public Key</a></li>            </ul></div></td></tr>');(function(a2){aV.find(".act-archive").click(function(){h.archiveAddr(a2)});aV.find(".act-label").click(function(){loadScript("wallet/address_modal",function(){showLabelAddressModal(a2)})});aV.find(".act-qr").click(function(){loadScript("wallet/address_modal",function(){showAddressModalQRCode(a2)})});aV.find(".act-pubkey").click(function(){h.getSecondPassword(function(){var a3=h.getPrivateKey(a2);if(a3==null){h.makeNotice("eror","misc-error","Public Key Unknown");return}var a4=new Bitcoin.ECKey(h.decodePK(a3));if(a4.getBitcoinAddressCompressed().toString()==a2){var a5=a4.getPubCompressed()}else{var a5=a4.getPub()}h.makeNotice("success","pub-key","Public Key of "+a2+" is "+Crypto.util.bytesToHex(a5),20000)})});aV.find(".act-sign").click(function(){loadScript("wallet/address_modal",function(){showAddressModalSignMessage(a2)})});aV.find(".act-request").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Create Payment Request",description:"Request Payment into address <b>"+a2+"</b>",src:root+"payment_request?address="+a2})})})})(a1.addr);if(a1.balance>0&&a1.priv){a0.prepend(aV)}else{a0.append(aV)}}aC()});$("#archived-addresses").on("show",function(){$("#enable_archived_checkbox").prop("checked",false);$("#archived-delete").prop("disabled",true);$("#archived-sweep").prop("disabled",true);$("#archived-addr tbody").empty();var aV=$(this).find("tbody");var aU=h.getArchivedAddresses();var aW=function(){aV.empty();for(var a0 in aU){var a2=I[aU[a0]];if(a2.tag!=2||(a2.tag==1&&!aq)){continue}var aZ="";if(a2.priv==null){aZ=' <font color="red">(Watch Only)</font>'}var aX="";var aY=a2.addr;if(a2.label!=null){aY=a2.label;aX='<span class="hidden-phone"> - '+a2.addr+"</span>"}var a1=$('<tr><td style="width:20px;"><input type="checkbox" class="archived_checkbox" value="'+a2.addr+'" disabled></td><td><div class="short-addr"><a href="'+root+"address/"+a2.addr+'" target="new">'+aY+"</a>"+aX+" "+aZ+'<div></td><td><span style="color:green">'+formatBTC(a2.balance)+'</span></td><td style="width:16px"><img src="'+resource+'unarchive.png" class="act-unarchive" /></td></tr>');(function(a3){a1.find(".act-unarchive").click(function(){h.unArchiveAddr(a3)})})(a2.addr);if(a2.balance>0&&a2.priv){aV.prepend(a1)}else{aV.append(a1)}}};aW();BlockchainAPI.get_balances(aU,function(aX){aW()},function(aX){h.makeNotice("error","misc-error",aX)})});$("#archived-sweep").click(function(){var aU=[];$(".archived_checkbox:checked").each(function(){var aV=I[$(this).val()];if(aV.priv==null){h.makeNotice("error","misc-error","Cannot Sweep Watch Only Address");return}aU.push(aV.addr)});if(aU.length==0){return}R(aU)});$("#archived-delete").click(function(){var aU=[];$(".archived_checkbox:checked").each(function(){aU.push($(this).val())});if(aU.length==0){return}ao(aU)});$("#shared-never-ask").click(function(){SetCookie("shared-never-ask",$(this).is(":checked"))});$(".bitstamp-btn").click(function(){window.open(root+"r?url=https://www.bitstamp.net/?blockchaininfo=1",null,"scroll=1,status=1,location=1,toolbar=1,width=1000,height=700")});$(".deposit-btn").click(function(){var aW=$(this);var aV=h.getPreferredAddress();var aU=aW.data("extra");if(aU==null){aU=""}loadScript("wallet/frame-modal",function(){showFrameModal({title:aW.data("title"),description:"Deposit into address <b>"+aV+"</b>",top_right:'Have Questions? Read <a href="'+aW.data("link")+'" target="new">How It Works</a>',src:root+"deposit?address="+aV+"&ptype="+aW.data("type")+"&guid="+M+aU})})});$(".withdraw-btn").click(function(){var aU=$(this);h.getSecondPassword(function(){var aV=h.getPreferredAddress();loadScript("wallet/frame-modal",function(){showFrameModal({title:aU.data("title"),description:"Your Wallet Balance is <b>"+formatBTC(ay)+"</b>",src:root+"withdraw?method="+aU.data("type")+"&address="+aV+"&balance="+ay+"&guid="+M})})})});$("#logout").click(h.logout);$("#refresh").click(function(){J(null,function(aU){h.makeNotice("error","misc-error",aU.responseText)});h.get_history()});$("#summary-n-tx-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Number of transactions",description:"",src:root+"charts/n-transactions?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#summary-received-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"BTC Received Per Day",description:"",src:root+"charts/received-per-day?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#summary-balance-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Wallet Balance",description:"",src:root+"charts/balance?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#new-addr").click(function(){try{J(function(){h.getSecondPassword(function(){var aW=h.generateNewKey();if(!aW){return}var aV=aW.getBitcoinAddress().toString();h.backupWallet("update",function(){h.makeNotice("info","new-address","Generated new Bitcoin Address "+aV);loadScript("wallet/address_modal",function(){showLabelAddressModal(aV)})})})})}catch(aU){h.makeNotice("error","misc-error",aU)}});$(".tx_filter a").click(function(){aw=0;ar=$(this).data("value");h.get_history()});$(".tx_display a").click(function(){var aU=$(this).data("value");if(aU=="export"){v();return}s.tx_display=aU;c();ai()});$("#email-backup-btn").click(function(){G()});$("#dropbox-backup-btn").click(function(){window.open(root+"wallet/dropbox-login?guid="+M)});$("#gdrive-backup-btn").click(function(){window.open(root+"wallet/gdrive-login?guid="+M)});$("#large-summary").click(function(){toggleSymbol();c()});$("#send-quick").on("show",function(aW,aV){var aU=$(this);r(aU,aV);aU.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aU,"quick",initNewTx())})})});$("#send-email").on("show",function(aW,aV){var aU=$(this);r(aU,aV);aU.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aU,"email",initNewTx())})})});$("#send-shared").on("show",function(aW,aV){var aU=$(this);r(aU,aV);aU.find(".mixer_fee").text(x);aU.find(".fees,.free,.bonus").show();if(x<0){aU.find(".fees,.free").hide()}else{if(x==0){aU.find(".fees,.bonus").hide()}else{aU.find(".free,.bonus").hide()}}aU.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aU,"shared",initNewTx())})});aU.find(".shared-fees").text("0.00");aU.find('input[name="send-before-fees"]').unbind().bind("keyup change",function(){var aY=parseFloat($(this).val());var aX=0;if(aY>0){if(x>0){aX=parseFloat(aY+((aY/100)*x))}else{aX=parseFloat(aY);aU.find(".bonus-value").text(formatPrecision((Math.min(aY,precisionFromBTC(200))/100)*x))}}if(precisionToBTC(aY)<0.1||precisionToBTC(aY)>250){aU.find(".shared-fees").text("0.00");aU.find(".send").prop("disabled",true)}else{aU.find(".shared-fees").text(formatBTC(aX*symbol_btc.conversion));aU.find(".send").prop("disabled",false)}aU.find('input[name="send-value"]').val(aX).trigger("keyup")})});$("#send-custom").on("show",function(aW,aV){var aU=$(this);r(aU,aV);aU.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aU,"custom",initNewTx())})});aU.find('select[name="from"]').unbind().change(function(){var aZ=0;var aX=$(this).val();for(var aY in aX){if(aX[aY]=="any"){$(this).val("any");aZ=ay;break}else{var a0=I[aX[aY]];if(a0&&a0.balance){aZ+=a0.balance}}}aU.find(".amount-available").text(formatBTC(aZ))}).trigger("change");aU.find(".reset").unbind().click(function(){r(aU,true);aU.find('select[name="from"]').trigger("change")})});$("#send-satoshi-dice,#send-btcdice-dice").on("show",function(aW,aV){var aU=this;loadScript("wallet/dicegames",function(){try{DICEGame.init($(aU))}catch(aX){h.makeNotice("error","misc-error","Unable To Load Dice Bets")}},function(aX){h.makeNotice("error","misc-error",aX)})});$("#send-sms").on("show",function(aW,aV){if(aV){return}var aU=$(this);r(aU);$.ajax({type:"GET",url:resource+"wallet/country_codes.html",success:function(aX){aU.find('select[name="sms-country-code"]').html(aX)},error:function(){h.makeNotice("error","misc-error","Error Downloading SMS Country Codes")}});aU.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){var aX=initNewTx();startTxUI(aU,"sms",aX)})})});$("#address-book").on("show",function(){var aV=$("#address-book-tbl tbody");if(aD(g)>0){aV.empty();for(var aU in g){var aW=$("<tr><td>"+g[aU]+'</td><td><div class="addr-book-entry">'+aU+'</div></td><td style="width:16px" class="hidden-phone"><img src="'+resource+'delete.png" class="act-delete" /></td></tr>');(function(aX){aW.find(".act-delete").click(function(){h.deleteAddressBook(aX)})})(aU);aV.append(aW)}}});$('a[data-toggle="tab"]').unbind().on("show",function(aU){$(aU.target.hash).trigger("show")});$("#receive-coins-btn").click(function(){af($("#receive-coins"))});$(".show_adv").click(function(){$(".modal:visible").center()});$(".download-backup-btn").show();aC()}function p(){$(".resend-code").click(function(){h.setGUID(M,true)});$("#reset-two-factor-btn").click(function(){window.open(root+"wallet/reset-two-factor"+(M?"?guid="+M:""))});$(".recover-wallet-btn").click(function(){window.open(root+"wallet/forgot-password"+(M?"?guid="+M:""))});$(".download-backup-btn").toggle(aj!=null).click(function(){if(!aj){h.makeNotice("error","error","No Wallet Data to Download");return}try{var aU=!!new Blob()}catch(aV){}if(aU){loadScript("wallet/filesaver",function(){var aW=new Blob([aj],{type:"text/plain;charset=utf-8"});saveAs(aW,"wallet.aes.json")})}else{h.makeNotice("error","error","Your browser is not support.")}aR()});$(".auth-0,.auth-1,.auth-2,.auth-3,.auth-4,.auth-5").unbind().keypress(function(aU){if(aU.keyCode==13){aU.preventDefault();$("#restore-wallet-continue").click()}});$("#restore-wallet-continue").unbind().click(function(aV){aV.preventDefault();var aU=$.trim($("#restore-guid").val());if(aU.length==0){return}if(M!=aU){h.setGUID(aU,false)}else{a()}});$(".modal").on("show",function(){L();$(this).center()}).on("shown",function(){L();$(this).center()})}function am(aV){var aW=Crypto.SHA256(aV+"?");switch(aW.slice(0,2)){case"00":var aX=Crypto.SHA256(aV,{asBytes:true});return aX;break;case"01":var aU=Crypto.util.hexToBytes(aW.slice(2,4))[0];var aY=Math.round(Math.pow(2,(aU/4)));var aX=Crypto.PBKDF2(aV,"Satoshi Nakamoto",32,{iterations:aY,asBytes:true});return aX;break;default:console.log("invalid key");break}}function aG(){var aW,aU="";if(window.getSelection){aW=window.getSelection();if(aW.rangeCount){var aX=aW.getRangeAt(0).cloneContents();var aV=document.createElement("div");aV.appendChild(aX);aU=aV.innerText}}else{if(document.selection&&document.selection.type=="Text"){aU=document.selection.createRange().htmlText}}return aU}this.detectPrivateKeyFormat=function(aV){if(/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(aV)){return"sipa"}if(/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(aV)){return"compsipa"}if(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{44}$/.test(aV)||/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{43}$/.test(aV)){return"base58"}if(/^[A-Fa-f0-9]{64}$/.test(aV)){return"hex"}if(/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(aV)){return"base64"}if(/^6P[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{56}$/.test(aV)){return"bip38"}if(/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(aV)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(aV)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(aV)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{30}$/.test(aV)){var aU=Crypto.SHA256(aV+"?",{asBytes:true});if(aU[0]===0||aU[0]===1){return"mini"}}throw"Unknown Key Format "+aV};this.privateKeyStringToKey=function(aV,aX){var aU=null;if(aX=="base58"){aU=B58.decode(aV)}else{if(aX=="base64"){aU=Crypto.util.base64ToBytes(aV)}else{if(aX=="hex"){aU=Crypto.util.hexToBytes(aV)}else{if(aX=="mini"){aU=am(aV)}else{if(aX=="sipa"){var aW=B58.decode(aV);aW.shift();aU=aW.slice(0,aW.length-4)}else{if(aX=="compsipa"){var aW=B58.decode(aV);aW.shift();aW.pop();aU=aW.slice(0,aW.length-4)}else{throw"Unsupported Key Format"}}}}}}if(aU.length!=32){throw"Result not 32 bytes in length"}return new Bitcoin.ECKey(aU)};$(document).ready(function(){if(!$.isEmptyObject({})){h.makeNotice("error","error","Object.prototype has been extended by a browser extension. Please disable this extensions and reload the page.");return}$("input,button,select").attr("autocomplete","off");var aV=$(document.body);function aW(){if(M&&M.length==36){setTimeout(function(){h.setGUID(M,false)},10)}else{$("#signup-btn").show()}}M=aV.data("guid");d=aV.data("sharedkey");X=aV.data("language");if(h.skip_init){return}MyStore.get("payload",function(a1){if(aj==null&&a1!=null){aj=a1;az=ah()}});MyStore.get("server_time_offset",function(a1){aK=parseInt(a1);if(isNaN(aK)){aK=0}});if((!M||M.length==0)&&(isExtension||window.location.href.indexOf("/login")>0)){MyStore.get("guid",function(a1){M=a1;aW()})}else{aW()}if(top.location!=self.location){top.location=self.location.href}aV.click(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).keypress(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).mousemove(function(a1){if(a1){rng_seed_int(a1.clientX*a1.clientY)}});p();$(".auth-"+q).show();j=$("#restore-wallet");j.show();var aX=false;var a0=17,aZ=86,aU=67,aY=67;$(document).keydown(function(a2){try{if(a2.keyCode==a0||a2.keyCode==aY){aX=true}if(aX&&a2.keyCode==aU){var a1=$.trim(aG());var a3=I[a1];if(a3!=null){if(a3.priv==null){$("#watch-only-copy-warning-modal").modal("show")}else{if(a3.tag==1){O()}}}}}catch(a2){console.log(a2)}}).keyup(function(a1){if(a1.keyCode==a0||a1.keyCode==aY){aX=false}}).ajaxStart(function(){au("loading_start");$(".loading-indicator").fadeIn(200)}).ajaxStop(function(){au("loading_stop");$(".loading-indicator").hide()})});function aT(){$("#receive-coins").find(".tab-pane.active").trigger("show");setupToggle()}};