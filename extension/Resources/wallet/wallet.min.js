function precisionToSatoshiBN(a){return Bitcoin.Util.parseValue(a).divide(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)).toString()))}function precisionToBTC(a){return Bitcoin.Util.formatValue(precisionToSatoshiBN(a))}function precisionFromBTC(a){return Bitcoin.Util.formatValue(Bitcoin.Util.parseValue(a).multiply(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)))))}function formatPrecision(a){return formatBTC(precisionToSatoshiBN(a).toString())}var MyWallet=new function(){var h=this;this.skip_init=false;var D="abcaa314-6f67-6705-b384-5d47fbe9d7cc";var ai;var M;var j;var aG;var ak;var w;var d;var ax=0;var S=0;var ar=0;var K=0;var aQ=0;var aE;var g={};var E=[];var F=false;var av=0;var aq=0;var aA=1000;var I={};var ay;var am;var x=0.5;var af=10;var P=af;var b={};var q;var aL=0;var U;var Y=[];var B;var N=60000;var A=false;var Z;var ap=false;var X="en";var ao=2;var Q=0;var s={pbkdf2_iterations:af,fee_policy:0,html5_notifications:false,logout_time:600000,tx_display:0,always_keep_local_backup:false};this.setEncryptedWalletData=function(aS){if(!aS||aS.length==0){ai=null;ay=null;return}ai=aS;ay=ag();try{if(aL==0||s.always_keep_local_backup){MyStore.put("payload",ai)}}catch(aT){console.log(aT)}};this.setRealAuthType=function(aS){aL=aS};this.getLanguage=function(){return X};this.addEventListener=function(aS){Y.push(aS)};this.getLogoutTime=function(){return s.logout_time};this.getSecondPasswordPbkdf2Iterations=function(){return s.pbkdf2_iterations};this.getMainPasswordPbkdf2Iterations=function(){return P};this.getDefaultPbkdf2Iterations=function(){return af};this.setLogoutTime=function(aS){s.logout_time=aS;clearInterval(U);U=setTimeout(h.logout,h.getLogoutTime())};this.getDoubleEncryption=function(){return F};this.getEncryptedWalletData=function(){return ai};this.getFeePolicy=function(){return s.fee_policy};this.setFeePolicy=function(aS){s.fee_policy=parseInt(aS)};this.setAlwaysKeepLocalBackup=function(aS){s.always_keep_local_backup=aS};this.getAlwaysKeepLocalBackup=function(){return s.always_keep_local_backup};this.getGuid=function(){return M};this.getHTML5Notifications=function(){return s.html5_notifications};this.setHTML5Notifications=function(aS){s.html5_notifications=aS};this.getTransactions=function(){return E};this.addressExists=function(aS){return I[aS]!=null};this.getAddressTag=function(aS){return I[aS].tag};this.setAddressTag=function(aT,aS){I[aT].tag=aS};this.getAddressBook=function(){return g};this.getAddressLabel=function(aS){return I[aS].label};this.setAddressLabel=function(aS,aT){I[aS].label=aT};this.setAddressBalance=function(aS,aT){I[aS].balance=aT};this.getAddressBookLabel=function(aS){return g[aS]};this.isWatchOnly=function(aS){return !I[aS]||I[aS].priv==null};this.getAddressBalance=function(aS){return I[aS].balance};this.getMixerFee=function(){return x};this.deleteAddress=function(aS){delete I[aS]};this.addAddressBookEntry=function(aT,aS){g[aT]=aS};this.getPrivateKey=function(aS){return I[aS].priv};this.setLabel=function(aS,aT){I[aS].label=aT;ah();c()};this.securePost=function(aT,aU,aV,aS){var aW=jQuery.extend({},aU);if(d==null||d.length==0||d.length!=36){throw"Shared key is invalid"}aW.sharedKey=d;aW.guid=M;aW.format=aU.format?aU.format:"plain";$.ajax({dataType:aU.format?aU.format:"text",type:"POST",url:root+aT,data:aW,success:function(aX){aV(aX)},error:function(aX){aS(aX)}})};this.isCorrectMainPassword=function(aS){return aG==aS};function ad(aT,aV){var aS=Crypto.SHA256(aT,{asBytes:true});for(var aU=1;aU<aV;++aU){aS=Crypto.SHA256(aS,{asBytes:true})}return Crypto.util.bytesToHex(aS)}this.setPbkdf2Iterations=function(aS,aU){var aT=function(aV){console.log("Panic "+aV);window.location.reload()};h.getSecondPassword(function(){try{if(F){for(var aV in I){var aX=I[aV];if(aX.priv){aX.priv=h.encrypt(h.decryptPK(aX.priv),d+ak,aS);if(!aX.priv){throw"addr.priv is null"}}}s.pbkdf2_iterations=aS;w=ad(d+ak,aS)}Q=2;P=aS;h.backupWallet("update",function(){aU()},function(){aT(aW)})}catch(aW){aT(aW)}},function(aV){aT(aV)})};this.setDoubleEncryption=function(aU,aS,aW){var aT=function(aX){console.log("Panic "+aX);window.location.reload()};try{if(F==aU){return}if(aU){h.getSecondPassword(function(){try{F=true;ak=aS;for(var aX in I){var aZ=I[aX];if(aZ.priv){aZ.priv=i(B58.decode(aZ.priv));if(!aZ.priv){throw"addr.priv is null"}}}w=ad(d+ak,s.pbkdf2_iterations);ak=null;h.getSecondPassword(function(){try{h.checkAllKeys();h.backupWallet("update",function(){aW()},function(){aT(a0)})}catch(a0){aT(a0)}},function(a0){aT(a0)})}catch(aY){aT(aY)}},function(aX){aT(aX)})}else{h.getSecondPassword(function(){try{for(var aX in I){var aZ=I[aX];if(aZ.priv){aZ.priv=h.decryptPK(aZ.priv);if(!aZ.priv){throw"addr.priv is null"}}}F=false;ak=null;h.checkAllKeys();h.backupWallet("update",function(){aW()},function(){aT(aY)})}catch(aY){aT(aY)}},function(aX){aT(aX)})}}catch(aV){aT(aV)}};this.unArchiveAddr=function(aS){var aS=I[aS];if(aS.tag==2){aS.tag=null;c();ah("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Unarchive This Address")}};this.archiveAddr=function(aS){if(h.getActiveAddresses().length<=1){h.makeNotice("error","add-error","You must leave at least one active address");return}var aS=I[aS];if(aS.tag==null||aS.tag==0){aS.tag=2;c();ah("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Archive This Address")}};this.addWatchOnlyAddress=function(aS){return aO(aS)};this.addPrivateKey=function(aS,aU){if(aj()){return false}if(aS==null){throw"Cannot add null key."}if(aU==null){aU={}}var aX=aU.compressed?aS.getBitcoinAddressCompressed().toString():aS.getBitcoinAddress().toString();var aW=i(aS.priv);if(aW==null){throw"Error Encoding key"}var aT=new Bitcoin.ECKey(h.decodePK(aW));if(aX!=aT.getBitcoinAddress().toString()&&aX!=aT.getBitcoinAddressCompressed().toString()){throw"Decoded Key address does not match generated address"}if(aO(aX,aW)){I[aX].tag=1;I[aX].created_time=aU.created_time?aU.created_time:0;I[aX].created_device_name=aU.app_name?aU.app_name:APP_NAME;I[aX].created_device_version=aU.app_version?aU.app_version:APP_VERSION;if(I[aX].priv!=aW){throw"Address priv does not match encoded"}try{ws.send('{"op":"addr_sub", "addr":"'+aX+'"}')}catch(aV){}}else{throw"Unable to add generated bitcoin address."}return aX};this._seed=function(aU){rng_seed_time();if(aG||aU){var aS=Crypto.util.bytesToWords(Crypto.SHA256(aG?aG:aU,{asBytes:true}));for(var aT in aS){rng_seed_int(aS[aT])}}if(!Z){Z=$("body").data("extra-seed")}if(Z){var aS=Crypto.util.bytesToWords(Crypto.util.hexToBytes(Z));for(var aT in aS){rng_seed_int(aS[aT])}}};this.generateNewKey=function(aT){h._seed(aT);var aS=new Bitcoin.ECKey(false);if(h.addPrivateKey(aS)){return aS}};this.setLoadingText=function(aS){$(".loading-text").text(aS)};function L(){try{$(".popover").remove()}catch(aS){}}$(window).resize(function(){$(".modal:visible").center();L()});function aN(aT,aS){aT.click(function(){z(aS.txIndex,aS.result)});aT.find(".show-note").mouseover(function(){var aU=aS.note?aS.note:b[aS.hash];aI(this,aU,aS.hash)});aT.find(".add-note").mouseover(function(){m(this,aS.hash)});return aT}function t(aT,aZ){var aS=0;for(var aV=0;aV<aT.inputs.length;++aV){var aU=aT.inputs[aV].prev_out;if(!aU||!aU.addr){continue}var aY=I[aU.addr];if(aY){var aX=parseInt(aU.value);aS-=aX;if(aZ){S+=aX;aY.balance-=aX}}}for(var aW=0;aW<aT.out.length;++aW){var aU=aT.out[aW];if(!aU||!aU.addr){continue}var aY=I[aU.addr];if(aY){var aX=parseInt(aU.value);aS+=aX;if(aZ){ar+=aX;aY.balance+=aX}}}return aS}function ag(){return Crypto.util.bytesToHex(Crypto.SHA256(ai,{asBytes:true}))}function y(aS){var aT=null;aS.onmessage=function(a0){try{var aX=$.parseJSON(a0.data);if(aX.op=="on_change"){var a1=ag();var aZ=aX.checksum;console.log("On change old "+a1+" ==  new "+aZ);if(aT!=aZ&&a1!=aZ){aT=aZ;J()}}else{if(aX.op=="utx"){var aY=TransactionFromJSON(aX.x);for(var a3 in E){if(E[a3].txIndex==aY.txIndex){return}}var a5=t(aY,true);if(h.getHTML5Notifications()){h.showNotification({title:a5>0?"Payment Received":"Payment Sent",body:"Transaction Value "+formatBTC(a5),iconUrl:resource+"cube48.png"})}aY.result=a5;ax+=a5;K++;aY.setConfirmations(0);playSound("beep");if(aq==0&&av==0){E.unshift(aY);var a2=false;if(E.length>50){E.pop();a2=true}}var aV=V();if("my-transactions"==aV){if(aq==0&&av==0){$("#no-transactions").hide();if(s.tx_display==0){var aU=$("#transactions-compact").show();aN($(C(aY,I,g)),aY).prependTo(aU.find("tbody")).find("div").hide().slideDown("slow");if(a2){aU.find("tbody tr:last-child").remove()}}else{var aU=$("#transactions-detailed").show();aU.prepend(aY.getHTML(I,g));if(a2){aU.find("div:last-child").remove()}setupSymbolToggle()}}}else{c()}}else{if(aX.op=="block"){for(var aW=0;aW<aX.x.txIndexes.length;++aW){for(var a4=0;a4<E.length;++a4){if(E[a4].txIndex==aX.x.txIndexes[aW]){if(E[a4].blockHeight==null||E[a4].blockHeight==0){E[a4].blockHeight=aX.x.height;break}}}}aw(BlockFromJSON(aX.x));W()}}}}catch(a0){console.log(a0);console.log(a0.data)}};aS.onopen=function(){at("ok");var aX='{"op":"blocks_sub"}';if(M!=null){aX+='{"op":"wallet_sub","guid":"'+M+'"}'}try{var aV=h.getActiveAddresses();for(var aU in aV){aX+='{"op":"addr_sub", "addr":"'+aV[aU]+'"}'}}catch(aW){alert(aW)}aS.send(aX)};aS.onclose=function(){at("error")}}var aM="ok";function at(aT){var aS=$("#logout");if(aT=="loading_start"){aS.attr("src",resource+"logout-orange.png");return}else{if(aT!="loading_stop"){aM=aT}}if(aM=="ok"){aS.attr("src",resource+"logout.png")}else{if(aM=="error"){aS.attr("src",resource+"logout-red.png")}}}this.showNotification=function(aS){try{if(window.webkitNotifications&&navigator.userAgent.indexOf("Chrome")>-1){if(webkitNotifications.checkPermission()==0){webkitNotifications.createNotification(aS.iconUrl,aS.title,aS.body).show()}}else{if(window.Notification){if(Notification.permissionLevel()=="granted"){new Notification(aS.title,aS).show()}}}}catch(aT){}};this.makeNotice=function(aT,aW,aV,aU){if(aV==null||aV.length==0){return}console.log(aV);if(aU==null){aU=5000}var aS=$('<div class="alert alert-block alert-'+aT+'"></div>');aS.text(""+aV);if($("#"+aW).length>0){aS.attr("id",aW);return}$("#notices").append(aS).hide().fadeIn(200);if(aU>0){(function(){var aX=aS;setTimeout(function(){aX.fadeOut(250,function(){$(this).remove()})},aU)})()}};this.pkBytesToSipa=function(aS,aW){var aT=new Bitcoin.ECKey(aS);while(aS.length<32){aS.unshift(0)}aS.unshift(128);if(aT.getBitcoinAddress().toString()==aW){}else{if(aT.getBitcoinAddressCompressed().toString()==aW){aS.push(1)}else{throw"Private Key does not match bitcoin address"+aW}}var aU=Crypto.SHA256(Crypto.SHA256(aS,{asBytes:true}),{asBytes:true});aS=aS.concat(aU.slice(0,4));var aV=B58.encode(aS);return aV};function aD(aS){return aS}function au(aS){return h.decryptPK(aS)}function ab(aS){var aT=h.decodePK(aS);return Crypto.util.bytesToBase64(aT)}function k(aS){var aT=h.decodePK(aS);return Crypto.util.bytesToHex(aT)}this.base58ToSipa=function(aS,aT){return h.pkBytesToSipa(h.decodePK(aS),aT)};this.makeWalletJSON=function(aS){return h.makeCustomWalletJSON(aS,M,d)};this.makeCustomWalletJSON=function(aX,aT,aZ){var aW=aD;if(aX=="base64"){aW=ab}else{if(aX=="hex"){aW=k}else{if(aX=="sipa"){aW=h.base58ToSipa}else{if(aX=="base58"){aW=au}}}}var aS='{\n	"guid" : "'+aT+'",\n	"sharedKey" : "'+aZ+'",\n';if(F&&w!=null&&aW==aD){aS+='	"double_encryption" : '+F+',\n	"dpasswordhash" : "'+w+'",\n'}if(s){aS+='	"options" : '+JSON.stringify(s)+",\n"}aS+='	"keys" : [\n';for(var aV in I){var aY=$.extend({},I[aV]);if(aY.tag==1){delete aY.tag}if(aY.priv!=null){aY.priv=aW(aY.priv,aY.addr)}for(var aU in aY){if(aY[aU]===null||aY[aU]===undefined){delete aY[aU]}}delete aY.balance;aS+=JSON.stringify(aY)+",\n";atLeastOne=true}if(atLeastOne){aS=aS.substring(0,aS.length-2)}aS+="\n	]";if(aC(g)>0){aS+=',\n	"address_book" : [\n';for(var aV in g){aS+='	{"addr" : "'+aV+'",\n';aS+='	 "label" : "'+g[aV]+'"},\n'}aS=aS.substring(0,aS.length-2);aS+="\n	]"}if(aC(b)>0){aS+=',\n	"tx_notes" : '+JSON.stringify(b)}aS+="\n}";return aS};this.get_history=function(aT,aS){BlockchainAPI.get_history(function(aU){H(aU,false);c();if(aT){aT()}},function(){if(aS){aS()}},aq,av)};this.deleteAddressBook=function(aS){delete g[aS];ah();$("#send-coins").find(".tab-pane").trigger("show",true)};function u(aS){$("#send-coins").find(".tab-pane.active").trigger("show",aS);if(aS){BlockchainAPI.get_ticker();$(".send").prop("disabled",false)}}function l(aS,aT,aX){var aW=aS.val();aS.empty();for(var aV in I){var aY=I[aV];if(!aY||aY.tag==2){continue}var aU=aY.label;if(!aU){aU=aY.addr.substring(0,15)+"..."}if(aT||aY.balance>0){aS.prepend('<option value="'+aY.addr+'">'+aU+" - "+formatBTC(aY.balance)+"</option>")}}aS.prepend('<option value="any" selected>Any Address</option>');if(!aX&&aW){aS.val(aW)}}function r(aU,aV){l(aU.find('select[name="from"]'),false,aV);l(aU.find('select[name="change"]'),true,aV);aU.find('select[name="change"]').prepend('<option value="new">New Address</option>');aU.find(".local-symbol").text(symbol_local.symbol);aU.find(".btc-symbol").text(symbol_btc.symbol);if(aV){aU.find("input").val("");aU.find(".send-value-usd").text(formatSymbol(0,symbol_local)).val("");aU.find(".amount-needed").text(0)}var aT=aU.find(".recipient-container");if(aV){var aX=aT.find(".recipient:first-child").clone();aT.empty().append(aX)}function aS(){var aY=BigInteger.ZERO;aU.find('input[name="send-value"]').each(function(){aY=aY.add(precisionToSatoshiBN($(this).val()))});return aY}function aW(aY){aY.find('input[name="send-to-address"]').typeahead({source:az()}).next().click(function(){var aZ=$(this).prev();h.scanQRCode(function(a0){console.log(a0);try{new Bitcoin.Address(a0);aZ.val(a0)}catch(a1){h.handleURI(a0,aY)}},function(a0){h.makeNotice("error","misc-error",a0)})});aY.find('input[name="send-value"]').unbind().bind("keyup change",function(aZ){if(aZ.keyCode=="9"){return}aU.find(".amount-needed").text(formatBTC(aS().toString()));aY.find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});aY.find(".send-value-usd").text(formatSymbol(0,symbol_local)).unbind().bind("keyup change",function(aZ){if(aZ.keyCode=="9"){return}aY.find('input[name="send-value"]').val(formatSatoshi(parseFloat($(this).val())*symbol_local.conversion,sShift(symbol_btc),true))})}aT.find(".recipient").each(function(){aW($(this))});aU.find(".remove-recipient").unbind().click(function(){var aY=aT.find(".recipient").length;if(aY>1){if(aY==2){$(this).hide(200)}aT.find(".recipient:last-child").remove()}});aU.find(".add-recipient").unbind().click(function(){var aY=aT.find(".recipient:first-child").clone();aY.appendTo(aT);aW(aY);aU.find(".remove-recipient").show(200)})}this.getAllAddresses=function(){var aT=[];for(var aS in I){aT.push(aS)}return aT};this.getPreferredAddress=function(){var aT=null;for(var aS in I){var aU=I[aS];if(aT==null){aT=aU}if(aU.priv!=null){if(aT==null){aT=aU}if(aU.tag==null||aU.tag==0){aT=aU;break}}}return aT.addr};function aP(){var aS=$("#restore-backup-modal");aS.modal({keyboard:true,backdrop:"static",show:true});aS.find(".btn.btn-secondary").unbind().click(function(){aS.modal("hide")})}this.scanQRCode=function(aU,aS){var aT=$("#qr-code-reader-modal");aT.modal({keyboard:false,backdrop:"static",show:true});loadScript("wallet/qr.code.reader",function(){QRCodeReader.init(aT,function(aV){aT.modal("hide");aU(aV)},function(aV){aT.modal("hide");aS(aV)})},aS);aT.find(".btn.btn-secondary").unbind().click(function(){QRCodeReader.stop();aT.modal("hide");aS()})};this.getActiveAddresses=function(){var aU=[];for(var aS in I){var aT=I[aS];if(aT.tag!=2){aU.push(aT.addr)}}return aU};this.getArchivedAddresses=function(){var aU=[];for(var aS in I){var aT=I[aS];if(aT.tag==2){aU.push(aT.addr)}}return aU};function aw(aV){if(aV!=null){aE=aV;for(var aT in E){var aS=E[aT];if(aS.blockHeight!=null&&aS.blockHeight>0){var aU=aE.height-aS.blockHeight+1;if(aU<=100){aS.setConfirmations(aE.height-aS.blockHeight+1)}else{aS.setConfirmations(null)}}else{aS.setConfirmations(0)}}}}function z(aT,aS){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Transaction Summary",description:"",src:root+"tx-summary/"+aT+"?result="+aS+"&guid="+M})})}this.deleteNote=function(aS){delete b[aS];c();ah()};function m(aS,aT){(function(aV,aX){aV=$(aV);if(!aV.data("popover")){aV.popover({title:'Add Note <span style="float:right"><i class="icon-remove-sign"></i></span>',trigger:"manual",content:'<textarea style="width:97%;height:50px;margin-top:2px" placeholder="Enter the note here..."></textarea><div style="text-align:right"><button class="btn btn-small">Save</button></div>'})}else{if(aV.data("popover").tip().is(":visible")){return}}aV.popover("show");aV.mouseleave(function(){if(!aV.__timeout){aV.__timeout=setTimeout(function(){aV.popover("hide")},250)}});function aU(){if(aV.__timeout){clearTimeout(aV.__timeout);aV.__timeout=null}}var aW=aV.data("popover").tip().mouseenter(aU);aW.find("textarea").focus(aU);aW.mouseleave(function(){aV.__timeout=setTimeout(function(){aV.popover("hide")},250)});aW.find("i").unbind().click(function(){aV.popover("hide")});aW.find("button").click(function(){var aY=stripHTML(aW.find("textarea").val()).replace(/'/g,"").replace(/"/g,"");if(aY.length>0){b[aX]=aY;ah()}c()})})(aS,aT)}function aI(aS,aT,aU){(function(aV,aW,aY){aV=$(aV);if(!aV.data("popover")){var aZ="Note";if(b[aY]){aZ+=' <span style="float:right"><img src="'+resource+'delete.png" /></span>'}$(aV).popover({title:aZ,trigger:"manual",content:$("<div/>").html(aW).text()})}else{if(aV.data("popover").tip().is(":visible")){return}}aV.popover("show");aV.mouseleave(function(){if(!aV.__timeout){aV.__timeout=setTimeout(function(){aV.popover("hide")},250)}});var aX=aV.data("popover").tip().mouseenter(function(){if(aV.__timeout){clearTimeout(aV.__timeout);aV.__timeout=null}});aX.find("img").unbind().click(function(){h.deleteNote(aY)});aX.mouseleave(function(){aV.__timeout=setTimeout(function(){aV.popover("hide")},250)})})(aS,aT,aU)}function C(aV,a0,aX){var a1=aV.result;var aW='<tr class="pointer" id="tx-'+aV.txIndex+'"><td class="hidden-phone" style="width:365px"><div><ul style="margin-left:0px;" class="short-addr">';var aT=true;if(a1>=0){for(var aU=0;aU<aV.inputs.length;++aU){var aS=aV.inputs[aU].prev_out;if(!aS||!aS.addr){aT=false;aW+='<span class="label">Newly Generated Coins</span>'}else{var aY=a0[aS.addr];if(aY){continue}aT=false;aW+=formatOutput(aS,a0,aX)}}}else{if(a1<0){for(var aU=0;aU<aV.out.length;++aU){var aS=aV.out[aU];var aY=a0[aS.addr];if(aY&&aS.type==0){continue}aT=false;aW+=formatOutput(aS,a0,aX)}}}if(aT){aW+='<span class="label">Moved Between Wallet</info>'}aW+="</ul></div></td><td><div>";var aZ=aV.note?aV.note:b[aV.hash];if(aZ){aW+='<img src="'+resource+'note.png" class="show-note"> '}else{aW+='<img src="'+resource+'note_grey.png" class="add-note"> '}if(aV.time>0){aW+=dateToString(new Date(aV.time*1000))}if(aV.confirmations==0){aW+=' <span class="label label-important hidden-phone">Unconfirmed Transaction!</span> '}else{if(aV.confirmations>0){aW+=' <span class="label label-info hidden-phone">'+aV.confirmations+" Confirmations</span> "}}aW+="</div></td>";if(a1>0){aW+='<td style="color:green"><div>'+formatMoney(a1,true)+"</div></td>"}else{if(a1<0){aW+='<td style="color:red"><div>'+formatMoney(a1,true)+"</div></td>"}else{aW+="<td><div>"+formatMoney(a1,true)+"</div></td>"}}if(aV.balance==null){aW+="<td></td></tr>"}else{aW+='<td class="hidden-phone"><div>'+formatMoney(aV.balance)+"</div></td></tr>"}return aW}function V(){L();if(ax==null){$("#balance").html("Loading...")}else{$("#balance").html(formatSymbol(ax,symbol,true));$("#balance2").html(formatSymbol(ax,(symbol===symbol_local)?symbol_btc:symbol_local),true)}return j.attr("id")}function c(aS){var aT=V();if("send-coins"==aT){u(aS)}else{if("home-intro"==aT){f(aS)}else{if("receive-coins"==aT){aR(aS)}else{if("my-transactions"==aT){W(aS)}}}}}function f(aS){$("#summary-n-tx").html(K);$("#summary-received").html(formatMoney(ar,true));$("#summary-sent").html(formatMoney(S,true));$("#summary-balance").html(formatMoney(ax,symbol));var aU=h.getPreferredAddress();$("#tweet-for-btc").unbind().click(function(){window.open("https://twitter.com/share?url=https://blockchain.info/wallet&hashtags=tweet4btc,bitcoin,"+aU+"&text=Sign Up For a Free Bitcoin Wallet @ Blockchain.info","","toolbar=0, status=0, width=650, height=360")});$(".paper-wallet-btn").unbind().click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showModal()})});if(h.isWatchOnly(aU)){$(".no-watch-only").hide()}else{$(".no-watch-only").show();var aT=$("#my-primary-address");if(aT.text()!=aU){aT.text(aU);loadScript("wallet/jquery.qrcode",function(){$("#my-primary-addres-qr-code").empty().qrcode({width:125,height:125,text:aU})})}}}function T(){var aS=$("#export-warning").show();var aT=$("#import-export-content").hide();$("#show-import-export").unbind().click(function(){h.getMainPassword(function(){aS.hide();loadScript("wallet/import-export",function(){ImportExport.init(aT,function(){aT.show()},function(){ae($("#home-intro"))})},function(aU){h.makeNotice("error","misc-error",aU);ae($("#home-intro"))})},function(){ae($("#home-intro"))})})}function W(){var aT=null;var aV=0;if(aT!=null){clearInterval(aT);aT=null}var aS;if(s.tx_display==0){$("#transactions-detailed").hide();aS=$("#transactions-compact").show().find("tbody").empty()}else{$("#transactions-compact").hide();aS=$("#transactions-detailed").empty().show()}if(E.length==0){$("#transactions-detailed, #transactions-compact").hide();$("#no-transactions").show();return}else{$("#no-transactions").hide()}var aU=function(){for(var aZ=aV;aZ<E.length&&aZ<(aV+10);++aZ){var aY=E[aZ];if(s.tx_display==0){aS.append(aN($(C(aY,I,g)),aY))}else{aS.append(aY.getHTML(I,g))}}aV+=10;if(aV<E.length){aT=setTimeout(aU,15)}else{setupSymbolToggle();L();var aX=$(".pagination ul").empty();if(av==0&&E.length<50){aX.hide();return}else{aX.show()}var aW=Math.ceil(aQ/50);var a0=" disabled";if(av>0){a0=""}aX.append($('<li class="prev'+a0+'"><a>&larr; Previous</a></li>').click(function(){h.setPage(av-1)}));for(var aZ=0;aZ<aW&&aZ<=10;++aZ){(function(a1){var a2="";if(av==a1){a2=' class="active"'}aX.append($("<li"+a2+'><a class="hidden-phone">'+a1+"</a></li>").click(function(){h.setPage(a1)}))})(aZ)}var a0=" disabled";if(av<aW){a0=""}aX.append($('<li class="next'+a0+'"><a>Next &rarr;</a></li>').click(function(){h.setPage(av+1)}))}};aU()}this.setPage=function(aS){av=aS;scroll(0,0);h.get_history()};function v(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Export History",description:"",src:root+"export-history?active="+h.getActiveAddresses().join("|")+"&archived="+h.getArchivedAddresses().join("|")})})}function H(aV,aU){if(!aU&&aV.mixer_fee){x=aV.mixer_fee}if(aV.disable_mixer){$("#shared-addresses,#send-shared").hide()}E.length=0;if(aV.wallet==null){ar=0;S=0;ax=0;K=0;aQ=0;return}ar=aV.wallet.total_received;S=aV.wallet.total_sent;ax=aV.wallet.final_balance;K=aV.wallet.n_tx;aQ=aV.wallet.n_tx_filtered;for(var aT=0;aT<aV.addresses.length;++aT){if(I[aV.addresses[aT].address]){I[aV.addresses[aT].address].balance=aV.addresses[aT].final_balance}}for(var aT=0;aT<aV.txs.length;++aT){var aS=TransactionFromJSON(aV.txs[aT]);aS.result=t(aS,false);E.push(aS)}if(aV.info){$("#nodes-connected").html(aV.info.nconnected);if(aV.info.latest_block){aw(aV.info.latest_block)}if(aV.info.symbol_local){setLocalSymbol(aV.info.symbol_local)}if(aV.info.symbol_btc){setBTCSymbol(aV.info.symbol_btc)}}}this.handleURI=function(aT,aS){loadScript("wallet/jsuri-1.1.1",function(){try{var aV=new Uri(aT);var aU=new Bitcoin.Address(aV.host());aS.find('input[name="send-to-address"]').val(aU.toString());var aW=parseFloat(aV.getQueryParamValue("amount"));if(aW>0&&!isNaN(aW)){aS.find('input[name="send-value"]').val(aW)}}catch(aX){console.log(aX);h.makeNotice("error","error","Invalid Bitcoin Address or URI")}},function(){h.makeNotice("error","error","Invalid Bitcoin Address or URI")})};function aJ(){J();U=setTimeout(h.logout,h.getLogoutTime());for(var aU in Y){Y[aU]("did_decrypt")}MyStore.get("multiaddr",function(aW){if(aW!=null){H($.parseJSON(aW),true);c()}});h.get_history();$("#initial_error,#initial_success").remove();var aV=decodeURIComponent(window.location.hash.replace("#",""));if(aV.indexOf("bitcoin:")==0){var aS=$("#send-coins");ae(aS);var aT=aS.find(".tab-pane.active").find(".recipient").first();h.handleURI(aV,aT)}else{ae($("#home-intro"))}window.location.hash=""}function J(aV,aS){for(var aT in I){var aW=I[aT];if(aW.tag==1){alert("Warning! wallet data may have changed but cannot sync as you have un-saved keys");return}}console.log("Get wallet with checksum "+ay);var aU={guid:M,sharedKey:d,format:"plain"};if(ay&&ay.length>0){aU.checksum=ay}$.ajax({type:"GET",url:root+"wallet/wallet.aes.json",data:aU,success:function(aX){if(aX==null||aX.length==0||aX=="Not modified"){if(aV){aV()}return}console.log("Wallet data modified");h.setEncryptedWalletData(aX);aa(function(){h.get_history();c();if(aV){aV()}},function(){window.location.reload();if(aS){aS()}})},error:function(){if(aS){aS()}}})}function aa(aT,aS){if(ai==null||ai.length==0){aS("No Wallet Data To Decrypt");return}h.decryptWallet(ai,aG,function(aY,aW){try{d=aY.sharedKey;if(d==null||d.length==0||d.length!=36){throw"Shared Key is invalid"}if(aW){Q=aW.version;P=aW.pbkdf2_iterations}if(aY.double_encryption&&aY.dpasswordhash){F=aY.double_encryption;w=aY.dpasswordhash}if(aY.options){$.extend(s,aY.options)}I={};for(var aV=0;aV<aY.keys.length;++aV){var aU=aY.keys[aV];if(aU.addr==null||aU.addr.length==0||aU.addr=="undefined"){h.makeNotice("error","null-error","Your wallet contains an undefined address. This is a sign of possible corruption, please double check all your BTC is accounted for. Backup your wallet to remove this error.",15000);continue}if(aU.tag==1){aU.tag=null}I[aU.addr]=aU}g={};if(aY.address_book){for(var aV=0;aV<aY.address_book.length;++aV){h.addAddressBookEntry(aY.address_book[aV].addr,aY.address_book[aV].label)}}if(aY.tx_notes){b=aY.tx_notes}if(ay==null||ay.length==0){ay=ag()}e();aT()}catch(aX){aS(aX)}},aS)}this.getPassword=function(aX,aY,aV){if(!aX.is(":visible")){aX.trigger("hidden");aX.unbind()}aX.modal({keyboard:false,backdrop:"static",show:true});aX.center();var aW=aX.find('input[name="password"]');var a0=aW,aS=false,aZ=false;aX.find(".vkeyboard li").unbind().click(function(){var a3=$(this),a2=a3.html();if(a3.hasClass("left-shift")||a3.hasClass("right-shift")){$(".letter").toggleClass("uppercase");$(".symbol span").toggle();aS=(aS===true)?false:true;aZ=false;return false}if(a3.hasClass("capslock")){$(".letter").toggleClass("uppercase");aZ=true;return false}if(a3.hasClass("delete")){var a1=a0.val();a0.val(a1.substr(0,a1.length-1));return false}if(a3.hasClass("symbol")){a2=$("span:visible",a3).html()}if(a3.hasClass("space")){a2=" "}if(a3.hasClass("tab")){a2="\t"}if(a3.hasClass("return")){a2="\n"}if(a3.hasClass("uppercase")){a2=a2.toUpperCase()}if(aS===true){$(".symbol span").toggle();if(aZ===false){$(".letter").toggleClass("uppercase")}aS=false}a0.val(a0.val()+a2)});aW.keypress(function(a1){if(a1.keyCode==13){a1.preventDefault();aX.find(".btn.btn-primary").click()}});aW.val("");var aT=aX.find(".btn.btn-primary");aT.click(function(){if(aY){aV=null;var a1=aY;aY=null;setTimeout(function(){aX.modal("hide");a1(aW.val())},10)}else{aX.modal("hide")}});var aU=aX.find(".btn.btn-secondary");aU.click(function(){if(aV){var a1=aV;aV=null;aY=null;setTimeout(function(){aX.modal("hide");try{a1()}catch(a2){h.makeNotice("error","misc-error",a2)}},10)}else{aX.modal("hide")}});aX.on("hidden",function(){aW.unbind();aU.unbind();aT.unbind();aX.unbind();if(aV){var a1=aV;aV=null;aY=null;setTimeout(function(){try{a1()}catch(a2){h.makeNotice("error","misc-error",a2)}},10)}})};this.makePairingQRCode=function(aT,aS){h.getMainPassword(function(){loadScript("wallet/jquery.qrcode",function(){try{if(aS==1){h.securePost("wallet",{method:"pairing-encryption-password"},function(aV){aT($("<div></div>").qrcode({width:300,height:300,text:"1|"+M+"|"+h.encrypt(d+"|"+Crypto.util.bytesToHex(UTF8.stringToBytes(aG)),aV,h.getDefaultPbkdf2Iterations())}))},function(aV){h.makeNotice("error","misc-error",aV)})}else{if(aS==0){aT($("<div></div>").qrcode({width:300,height:300,text:M+"|"+d+"|"+aG}))}}}catch(aU){h.makeNotice("error","misc-error",aU)}})},function(){h.logout()})};this.getMainPassword=function(aT,aS){if(B>new Date().getTime()-N){return aT(aG)}h.getPassword($("#main-password-modal"),function(aU){if(aG==aU){B=new Date().getTime();if(aT){try{aT(aG)}catch(aV){h.makeNotice("error","misc-error",aV)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aS){try{aS()}catch(aV){h.makeNotice("error","misc-error",aV)}}}},aS)};this.getSecondPassword=function(aU,aS){if(!F||ak!=null){if(aU){try{aU(ak)}catch(aT){h.makeNotice("error","misc-error",aT)}}return}h.getPassword($("#second-password-modal"),function(aV){try{if(aH(aV)){if(aU){try{aU(aV)}catch(aW){console.log(aW);h.makeNotice("error","misc-error",aW)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aS){try{aS()}catch(aW){h.makeNotice("error","misc-error",aW)}}}}catch(aW){if(aS){try{aS()}catch(aW){h.makeNotice("error","misc-error",aW)}}}},aS)};function a(){if(A){return}var aS=$("#restore-password");aG=aS.val();aS.val("");B=new Date().getTime();if(ai==null||ai.length==0){h.setLoadingText("Validating Authentication key");var aT=$.trim($(".auth-"+q).find(".code").val());if(aT.length==0||aT.length>255){h.makeNotice("error","misc-error","You must enter a Two Factor Authentication code");return false}$.ajax({type:"POST",url:root+"wallet",data:{guid:M,payload:aT,length:aT.length,method:"get-wallet",format:"plain"},success:function(aU){try{if(aU==null||aU.length==0){h.makeNotice("error","misc-error","Server Return Empty Wallet Data");return}if(aU!="Not modified"){h.setEncryptedWalletData(aU)}$(".auth-"+q).hide();$(".auth-0").show();aa(function(){n();aJ()},function(aW){h.makeNotice("error","misc-error",aW)})}catch(aV){h.makeNotice("error","misc-error",aV)}},error:function(aU){h.makeNotice("error","misc-error",aU.responseText)}})}else{aa(function(){n();aJ()},function(aU){h.makeNotice("error","misc-error",aU)})}}function O(){$("#not-synced-warning-modal").modal("show").find(".btn.btn-danger").unbind().click(function(){$(this).modal("hide");ap=true;c()})}function e(){at("error");webSocketConnect(y);A=true;$("#tech-faq").hide();$("#intro-text").hide();$("#large-summary").show()}this.quickSendNoUI=function(aU,aT,aS){loadScript("wallet/signer",function(){h.getSecondPassword(function(){try{var aW=initNewTx();aW.from_addresses=h.getActiveAddresses();aW.to_addresses.push({address:new Bitcoin.Address(aU),value:Bitcoin.Util.parseValue(aT)});aW.addListener(aS);aW.start()}catch(aV){aS.on_error(aV)}},function(aV){aS.on_error(aV)})})};function G(){h.setLoadingText("Sending email backup");$.ajax({type:"POST",url:root+"wallet",data:{guid:M,sharedKey:d,method:"email-backup",format:"plain"},success:function(aS){h.makeNotice("success","backup-success",aS)},error:function(aS){h.makeNotice("error","misc-error",aS.responseText)}})}function ah(aV,aU,aT,aS){if(am){clearInterval(am);am=null}am=setTimeout(function(){h.backupWallet(aV,aU,aT,aS)},3000)}this.backupWallet=function(aY,aX,aT){if(am){clearInterval(am);am=null}var aS=function(aZ){h.makeNotice("error","misc-error","Error Saving Wallet: "+aZ,10000);c();if(aT!=null){aT(aZ)}else{throw aZ}};try{if(aY==null){aY="update"}if(aC(I)==0){return}var aU=h.makeWalletJSON();var aW=h.encryptWallet(aU,aG);if(aW.length==0){throw"Error encrypting the JSON output"}h.decryptWallet(aW,aG,function(a1){try{var aZ=ay;h.setLoadingText("Saving wallet");h.setEncryptedWalletData(aW);$.ajax({type:"POST",url:root+"wallet",data:{guid:M,length:aW.length,payload:aW,sharedKey:d,checksum:ay,old_checksum:aZ,method:aY},converters:{"* text":window.String,"text html":true,"text json":window.String,"text xml":window.String},success:function(a3){for(var a2 in I){var a4=I[a2];if(a4.tag==1){delete a4.tag}}h.makeNotice("success","misc-success",a3);c();if(aX!=null){aX()}},error:function(a3){for(var a2 in I){var a4=I[a2];if(a4.tag==1){O();break}}aS(a3.responseText)}})}catch(a0){aS(a0)}})}catch(aV){aS(aV)}};function aK(aS){if(F){if(ak==null){throw"Cannot encrypt private key without a password"}return h.encrypt(aS,d+ak,h.getSecondPasswordPbkdf2Iterations())}else{return aS}return null}this.isBase58=function(aU,aT){for(var aS=0;aS<aU.length;++aS){if(aU[aS]<0||aU[aS]>58){return false}}return true};this.encrypt=function(aU,aT,aS){return Crypto.AES.encrypt(aU,aT,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aS})};this.encryptWallet=function(aT,aS){if(Q==2){return JSON.stringify({pbkdf2_iterations:h.getMainPasswordPbkdf2Iterations(),version:Q,payload:h.encrypt(aT,aS,h.getMainPasswordPbkdf2Iterations())})}else{if(Q==0){return h.encrypt(aT,aS,h.getDefaultPbkdf2Iterations())}else{throw"Unknown encryption version "+Q}}};this.decryptWallet=function(aT,aZ,a0,aW){try{var aS=null;try{var aS=$.parseJSON(aT)}catch(aU){console.log(aU)}var aV=function(){try{var a2=Crypto.AES.decrypt(aS.payload,aZ,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aS.pbkdf2_iterations});var a1=$.parseJSON(a2);a0(a1,aS)}catch(a3){aW("Error Decrypting Wallet. Please check your password is correct.")}};if(aS&&aS.payload&&aS.pbkdf2_iterations){if(aS.version!=ao){throw"Wallet version "+aS.version+" not supported"}if(aS.pbkdf2_iterations>100){var aY=$("#decrypting-progress-modal");var aX=setTimeout(function(){aY.modal({keyboard:false,backdrop:"static",show:true});aY.center()},500);h.decryptWebWorker(aS.payload,aZ,aS.pbkdf2_iterations,function(a2){clearTimeout(aX);aY.modal("hide");try{var a1=$.parseJSON(a2);a0(a1,aS)}catch(a3){aV()}},function(){clearTimeout(aX);aY.modal("hide");aV()})}else{aV()}}else{h.decrypt(aT,aZ,h.getDefaultPbkdf2Iterations(),function(a2){try{var a1=$.parseJSON(a2);try{a0(a1)}catch(a3){console.log(a3)}return true}catch(a3){return false}},function(){aW("Error Decrypting Wallet. Please check your password is correct.")})}}catch(aU){if(aW){aW(aU)}}};this.decryptWebWorker=function(aV,aZ,aU,a0,aY){var aS=false;var aX=function(a1){if(!aS){aY(a1);aS=true}};try{var aT=new Worker(resource+"wallet/signer"+(min?".min.js":".js"));aT.addEventListener("message",function(a2){var a1=a2.data;try{switch(a1.cmd){case"on_decrypt":a0(a1.data);aT.terminate();break;case"on_error":throw a1.e}}catch(a2){aT.terminate();aX(a2)}},false);aT.addEventListener("error",function(a1){aX(a1)});aT.postMessage({cmd:"load_resource",path:resource+"wallet/bitcoinjs"+(min?".min.js":".js")});aT.postMessage({cmd:"decrypt",data:aV,password:aZ,pbkdf2_iterations:aU})}catch(aW){aX(aW)}};this.decrypt=function(aW,aV,aT,aY,aU){try{var aS=Crypto.AES.decrypt(aW,aV,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aT});if(aS!=null&&aS.length>0){if(aY(aS)){return aS}}}catch(aX){console.log(aX)}if(aT!=10){try{var aS=Crypto.AES.decrypt(aW,aV,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:10});if(aS!=null&&aS.length>0){if(aY(aS)){return aS}}}catch(aX){console.log(aX)}}try{var aS=Crypto.AES.decrypt(aW,aV);if(aS!=null&&aS.length>0){if(aY(aS)){return aS}}}catch(aX){console.log(aX)}try{var aS=Crypto.AES.decrypt(aW,aV,{mode:new Crypto.mode.OFB(Crypto.pad.iso7816),iterations:1});if(aS!=null&&aS.length>0){if(aY(aS)){return aS}}}catch(aX){console.log(aX)}try{var aS=Crypto.AES.decrypt(aW,aV,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:1});if(aS!=null&&aS.length>0){if(aY(aS)){return aS}}}catch(aX){console.log(aX)}if(aU){aU()}return null};this.setGUID=function(aU,aS){console.log("Set GUID "+aU);if(A){throw"Cannot Set GUID Once Initialized"}h.setLoadingText("Changing Wallet Identifier");$("#initial_error,#initial_success").remove();var aT=$("#restore-wallet-continue");aT.prop("disabled",true);var aV={format:"json",resend_code:aS};if(ay){aV.checksum=ay}$.ajax({type:"GET",dataType:"json",url:root+"wallet/"+aU,data:aV,timeout:10000,success:function(aW){aT.prop("disabled",false);if(!aW.guid){h.makeNotice("error","misc-error","Server returned null guid.");return}$(".auth-"+q).hide();Z=aW.extra_seed;M=aW.guid;q=aW.auth_type;aL=aW.real_auth_type;if(aW.language){X=aW.language}if(aW.payload&&aW.payload.length>0&&aW.payload!="Not modified"){h.setEncryptedWalletData(aW.payload)}war_checksum=aW.war_checksum;setLocalSymbol(aW.symbol_local);$("#restore-guid").val(M);$(".auth-"+q).show();if(aW.initial_error){h.makeNotice("error","misc-error",aW.initial_error)}if(aW.initial_success){h.makeNotice("success","misc-success",aW.initial_success)}MyStore.get("guid",function(aX){if(aX!=M){MyStore.clear();if(M!=D){MyStore.put("guid",M)}}})},error:function(aW){console.log("Set GUID Success");aT.prop("disabled",false);MyStore.get("guid",function(aX){if(aX==aU&&ai){h.makeNotice("error","misc-error","Error Contacting Server. Using Local Wallet Cache.");M=aX;ay=ag();q=0;$("#restore-guid").val(M);$(".auth-"+q).show();return}try{var aZ=$.parseJSON(aW.responseText);if(aZ.initial_error){h.makeNotice("error","misc-error",aZ.initial_error);return}}catch(aY){}if(aW.responseText){h.makeNotice("error","misc-error",aW.responseText)}else{h.makeNotice("error","misc-error","Error changing wallet identifier")}})}})};function i(aS){var aT=B58.encode(aS);return aK(aT)}this.decryptPK=function(aS){if(F){if(ak==null){throw"Cannot decrypt private key without a password"}return h.decrypt(aS,d+ak,h.getSecondPasswordPbkdf2Iterations(),h.isBase58)}else{return aS}return null};this.decodePK=function(aT){if(!aT){throw"null PK passed to decodePK"}var aS=h.decryptPK(aT);if(aS!=null){return B58.decode(aS)}return null};this.signmessage=function(aS,aU){var aW=I[aS];if(!aW.priv){throw"Cannot sign a watch only address"}var aV=h.decodePK(aW.priv);var aT=new Bitcoin.ECKey(aV);return Bitcoin.Message.signMessage(aT,aU,aW.addr)};function aH(aT){var aS=Crypto.SHA256(d+aT,{asBytes:true});var aW=ad(aS,h.getSecondPasswordPbkdf2Iterations()-1);if(aW==w){ak=aT;return true}if(h.getSecondPasswordPbkdf2Iterations()!=10){var aU=ad(aS,10-1);if(aU==w){ak=aT;w=aW;return true}}if(Crypto.util.bytesToHex(aS)==w){ak=aT;w=aW;return true}var aV=Crypto.SHA256(aT);if(aV==w){ak=aT;w=aW;return true}return false}this.runCompressedCheck=function(){var aS=[];var aU={};for(var aV in I){var aZ=I[aV];if(aZ.priv!=null){var aY=h.decodePK(aZ.priv);var aW=new Bitcoin.ECKey(aY);var aT=aW.getBitcoinAddress().toString();var aX=aW.getBitcoinAddressCompressed().toString();if(aZ.addr!=aT){aU[aT]=aZ.priv;aS.push(aT)}if(aZ.addr!=aX){aU[aX]=aZ.priv;aS.push(aX)}}}if(aS.length==0){alert("to_check length == 0")}BlockchainAPI.get_balances(aS,function(a1){var a2=0;for(var a0 in a1){var a3=a1[a0].final_balance;if(a3>0){alert(formatBTC(a3)+" claimable in address "+a0+" (Import PK : "+h.base58ToSipa(aU[a0],a0)+")")}a2+=a3}alert(formatBTC(a3)+" found in compressed addresses")})};this.checkAllKeys=function(aS){for(var aT in I){var aX=I[aT];if(aX.addr==null){throw"Null Address Found in wallet "+aT}if(aX.addr.toString()==null){throw"Error decoding wallet address "+aX.addr}if(aX.priv!=null){var aW=h.decodePK(aX.priv);var aV=new Bitcoin.ECKey(aW);var aU=aV.getBitcoinAddress().toString();if(aU!=aX.addr&&aV.getBitcoinAddressCompressed().toString()!=aX.addr){throw"Private key does not match bitcoin address "+aX.addr+" != "+aU}if(aS){aX.priv=i(aW)}}}h.makeNotice("success","wallet-success","Wallet verified.")};this.setMainPassword=function(aS){h.getMainPassword(function(){aG=aS;h.backupWallet("update",function(){h.logout()},function(){h.logout()})})};function ae(aS){if(aS===j){return}if(j!=null){if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","")}j.hide()}j=aS;j.show();if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","active")}c(true)}function aC(aU){var aT=0,aS;for(aS in aU){aT++}return aT}function ac(aS){I[aS].priv=null}function aj(){if(aC(I)>=aA){h.makeNotice("error","misc-error","We currently support a maximum of "+aA+" private keys, please remove some unused ones.");return true}return false}function aO(aU,aS){var aT=I[aU];if(!aT||aT.length==0){I[aU]={addr:aU,priv:aS,balance:0};return true}else{if(!aT.priv&&aS){aT.priv=aS;return true}}return false}function o(){var aU=$("#add-address-book-entry-modal");aU.modal({keyboard:true,backdrop:"static",show:true});var aS=aU.find('input[name="label"]');var aT=aU.find('input[name="address"]');aS.val("");aT.val("");aU.find(".btn.btn-primary").unbind().click(function(){aU.modal("hide");var aW=stripHTML(aS.val());var aV=stripHTML(aT.val());if(aW.length==0||aV.length==0){h.makeNotice("error","misc-error","You must enter an address and label for the address book entry");return false}var aY;try{aY=new Bitcoin.Address(aV);if(aY==null){throw"Null address"}}catch(aX){h.makeNotice("error","misc-error","Bitcoin address invalid, please make sure you entered it correctly");return false}if(g[aV]!=null){h.makeNotice("error","misc-error","Bitcoin address already exists");return false}h.makeNotice("success","misc-success","Added Address book entry");h.addAddressBookEntry(aV,aW);ah();$("#send-coins").find(".tab-pane").trigger("show",true)});aU.find(".btn.btn-secondary").unbind().click(function(){aU.modal("hide")})}this.logout=function(){if(U){clearTimeout(U)}if(M==D){window.location=root+"wallet/logout"}else{$.ajax({type:"GET",url:root+"wallet/logout",data:{format:"plain"},success:function(aS){window.location.reload()},error:function(){window.location.reload()}})}};function an(aY){var a0=$("#delete-address-modal");a0.modal({keyboard:true,backdrop:"static",show:true});a0.find(".btn.btn-primary").hide();a0.find(".btn.btn-danger").hide();$("#change-mind").hide();a0.find("#to-delete-address").html(aY.join(" "));a0.find("#delete-balance").empty();var aU=a0.find("#delete-balance");var aS=[];for(var aX in aY){var aZ=aY[aX];if(I[aZ]&&I[aZ].priv){aS.push(aY[aX])}}BlockchainAPI.get_balance(aS,function(a1){a0.find(".btn.btn-primary").show(200);a0.find(".btn.btn-danger").show(200);aU.html("Balance "+formatBTC(a1));if(a1>0){aU.css("color","red")}else{aU.css("color","black")}},function(){a0.find(".btn.btn-primary").show(200);a0.find(".btn.btn-danger").show(200);aU.text("Error Fetching Balance")});var aV=false;var aX=0;var aT=null;var aW=10;changeMind=function(){$("#change-mind").show();$("#change-mind-time").text(aW-aX)};a0.find(".btn.btn-primary").unbind().click(function(){changeMind();a0.find(".btn.btn-primary").hide();a0.find(".btn.btn-danger").hide();aT=setInterval(function(){if(aV){return}++aX;changeMind();if(aX==aW){$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Private Key Removed From Wallet");for(var a1 in aY){ac(aY[a1])}c();h.backupWallet();clearInterval(aT)}},1000)});a0.find(".btn.btn-danger").unbind().click(function(){changeMind();a0.find(".btn.btn-primary").hide();a0.find(".btn.btn-danger").hide();aT=setInterval(function(){if(aV){return}++aX;changeMind();if(aX==aW){try{$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Address & Private Key Removed From Wallet");for(var a1 in aY){h.deleteAddress(aY[a1])}c();h.backupWallet("update",function(){h.get_history()})}finally{clearInterval(aT)}}},1000)});a0.unbind().on("hidden",function(){if(aT){aV=true;clearInterval(aT);aT=null}});a0.find(".btn.btn-secondary").unbind().click(function(){a0.modal("hide")})}function az(){var aU=[];for(var aS in g){aU.push(g[aS])}for(var aS in I){var aT=I[aS];if(aT.tag!=2&&aT.label){aU.push(aT.label)}}return aU}function R(aS){h.getSecondPassword(function(){var aU=$("#sweep-address-modal");aU.modal("show");BlockchainAPI.get_balance(aS,function(aV){aU.find(".balance").text("Amount: "+formatBTC(aV))},function(){aU.find(".balance").text("Error Fetching Balance")});var aT=aU.find('select[name="change"]');l(aT,true);aU.find(".btn.btn-primary").unbind().click(function(){loadScript("wallet/signer",function(){BlockchainAPI.get_balance(aS,function(aV){var aW=initNewTx();aW.fee=aW.base_fee;aW.to_addresses.push({address:new Bitcoin.Address($.trim(aT.val())),value:BigInteger.valueOf(aV).subtract(aW.fee)});aW.from_addresses=aS;aW.start()},function(){h.makeNotice("error","misc-error","Error Getting Address Balance")})});aU.modal("hide")});aU.find(".btn.btn-secondary").unbind().click(function(){aU.modal("hide")})})}function aB(){try{$(".pop").popover({offset:10,placement:"bottom"})}catch(aS){}}function n(){$("#add-address-book-entry-btn").click(function(){o()});$("#home-intro-btn").click(function(){ae($("#home-intro"))});$("#my-transactions-btn").click(function(){ae($("#my-transactions"))});$("#send-coins-btn").click(function(){ae($("#send-coins"))});$("#import-export-btn").click(function(){ae($("#import-export"));T()});$("#chord-diagram").click(function(){window.open(root+"taint/"+h.getActiveAddresses().join("|"),null,"width=850,height=850")});$("#verify-message").click(function(){loadScript("wallet/address_modal",function(){verifyMessageModal()})});$("#generate-cold-storage").click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showColdStorageModal()},null,true)});$("#group-received").click(function(){loadScript("wallet/taint_grouping",function(){try{loadTaintData()}catch(aS){h.makeNotice("error","misc-error","Unable To Load Taint Grouping Data")}})});$("#my-account-btn").click(function(){ae($("#my-account"));var aS=$("#account-settings-warning").show();var aT=$("#my-account-content").hide();$("#show-account-settings").unbind().click(function(){h.getMainPassword(function(){aS.hide();loadScript("wallet/account",function(){AccountSettings.init(aT,function(){aT.show()},function(){ae($("#home-intro"))})},function(aU){h.makeNotice("error","misc-error",aU);ae($("#home-intro"))})},function(){ae($("#home-intro"))})})});$("#enable_archived_checkbox").change(function(){var aS=$(this).is(":checked");$(".archived_checkbox").prop("checked",false);$(".archived_checkbox").prop("disabled",!aS);$("#archived-sweep").prop("disabled",!aS);$("#archived-delete").prop("disabled",!aS)});$("#shared-addresses").on("show",function(){var aS=$(this);loadScript("wallet/shared-addresses",function(){buildSharedTable(aS)})});$("#active-addresses").on("show",function(){var aY=$(this).find("table:first");aY.find("tbody:gt(0)").remove();var aV=aY.find("tbody").empty();for(var aX in I){var aZ=I[aX];if(aZ.tag==2||(aZ.tag==1&&!ap)){continue}var aW="";if(aZ.tag==1){aW=' <font color="red" class="pop" title="Not Synced" data-content="This is a new address which has not yet been synced with our the server. Do not used this address yet.">(Not Synced)</font>'}else{if(aZ.priv==null){aW=' <font color="red" class="pop" title="Watch Only" data-content="Watch Only means there is no private key associated with this bitcoin address. <br /><br /> Unless you have the private key stored elsewhere you do not own the funds at this address and can only observe the transactions.">(Watch Only)</font>'}}var aS="";var aU=aZ.addr;if(aZ.label!=null){aU=aZ.label;aS='<span class="hidden-phone"> - '+aZ.addr+"</span>"}var aT=$('<tr><td><div class="short-addr"><a href="'+root+"address/"+aZ.addr+'" target="new">'+aU+"</a>"+aS+" "+aW+'<div></td><td><span style="color:green">'+formatMoney(aZ.balance,true)+'</span></td>            <td><div class="btn-group pull-right"><a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#"><span class="hidden-phone">Actions </span><span class="caret"></span></a><ul class="dropdown-menu">             <li><a href="#" class="pop act-archive" title="Archive Address" data-content="Click this button to hide the address from the main view. You can restore or delete later by finding it in the Archived addresses tab.">Archive Address</a></li>            <li><a href="#" class="pop act-label" title="Label Address" data-content="Set the label for this address.">Label Address</a></li>            <li><a href="#" class="pop act-qr" title="Show QR Code" data-content="Show a QR Code for this address.">QR Code</a></li>            <li><a href="#" class="pop act-sign" title="Sign Message" data-content="Sign A message with this address.">Sign Message</a></li>            <li><a href="#" class="pop act-request" title="Request Payment" data-content="Click here to create a new QR Code payment request. The QR Code can be scanned using most popular bitcoin software and mobile apps.">Create Payment Request</a></li>            <li><a href="#" class="pop act-pubkey">Show Public Key</a></li>            </ul></div></td></tr>');(function(a0){aT.find(".act-archive").click(function(){h.archiveAddr(a0)});aT.find(".act-label").click(function(){loadScript("wallet/address_modal",function(){showLabelAddressModal(a0)})});aT.find(".act-qr").click(function(){loadScript("wallet/address_modal",function(){showAddressModalQRCode(a0)})});aT.find(".act-pubkey").click(function(){h.getSecondPassword(function(){var a1=h.getPrivateKey(a0);if(a1==null){h.makeNotice("eror","misc-error","Public Key Unknown");return}var a2=new Bitcoin.ECKey(h.decodePK(a1));if(a2.getBitcoinAddressCompressed().toString()==a0){var a3=a2.getPubCompressed()}else{var a3=a2.getPub()}h.makeNotice("success","pub-key","Public Key of "+a0+" is "+Crypto.util.bytesToHex(a3),20000)})});aT.find(".act-sign").click(function(){loadScript("wallet/address_modal",function(){showAddressModalSignMessage(a0)})});aT.find(".act-request").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Create Payment Request",description:"Request Payment into address <b>"+a0+"</b>",src:root+"payment_request?address="+a0})})})})(aZ.addr);if(aZ.balance>0&&aZ.priv){aY.prepend(aT)}else{aY.append(aT)}}aB()});$("#archived-addresses").on("show",function(){$("#enable_archived_checkbox").prop("checked",false);$("#archived-delete").prop("disabled",true);$("#archived-sweep").prop("disabled",true);$("#archived-addr tbody").empty();var aT=$(this).find("tbody");var aS=h.getArchivedAddresses();var aU=function(){aT.empty();for(var aY in aS){var a0=I[aS[aY]];if(a0.tag!=2||(a0.tag==1&&!ap)){continue}var aX="";if(a0.priv==null){aX=' <font color="red">(Watch Only)</font>'}var aV="";var aW=a0.addr;if(a0.label!=null){aW=a0.label;aV='<span class="hidden-phone"> - '+a0.addr+"</span>"}var aZ=$('<tr><td style="width:20px;"><input type="checkbox" class="archived_checkbox" value="'+a0.addr+'" disabled></td><td><div class="short-addr"><a href="'+root+"address/"+a0.addr+'" target="new">'+aW+"</a>"+aV+" "+aX+'<div></td><td><span style="color:green">'+formatBTC(a0.balance)+'</span></td><td style="width:16px"><img src="'+resource+'unarchive.png" class="act-unarchive" /></td></tr>');(function(a1){aZ.find(".act-unarchive").click(function(){h.unArchiveAddr(a1)})})(a0.addr);if(a0.balance>0&&a0.priv){aT.prepend(aZ)}else{aT.append(aZ)}}};aU();BlockchainAPI.get_balances(aS,function(aV){aU()},function(aV){h.makeNotice("error","misc-error",aV)})});$("#archived-sweep").click(function(){var aS=[];$(".archived_checkbox:checked").each(function(){var aT=I[$(this).val()];if(aT.priv==null){h.makeNotice("error","misc-error","Cannot Sweep Watch Only Address");return}aS.push(aT.addr)});if(aS.length==0){return}R(aS)});$("#archived-delete").click(function(){var aS=[];$(".archived_checkbox:checked").each(function(){aS.push($(this).val())});if(aS.length==0){return}an(aS)});$("#shared-never-ask").click(function(){SetCookie("shared-never-ask",$(this).is(":checked"))});$(".bitstamp-btn").click(function(){window.open(root+"r?url=https://www.bitstamp.net/?blockchaininfo=1",null,"scroll=1,status=1,location=1,toolbar=1,width=1000,height=700")});$(".deposit-btn").click(function(){var aU=$(this);var aT=h.getPreferredAddress();var aS=aU.data("extra");if(aS==null){aS=""}loadScript("wallet/frame-modal",function(){showFrameModal({title:aU.data("title"),description:"Deposit into address <b>"+aT+"</b>",top_right:'Have Questions? Read <a href="'+aU.data("link")+'" target="new">How It Works</a>',src:root+"deposit?address="+aT+"&ptype="+aU.data("type")+"&guid="+M+"&sharedKey="+d+aS})})});$(".withdraw-btn").click(function(){var aS=$(this);h.getSecondPassword(function(){var aT=h.getPreferredAddress();loadScript("wallet/frame-modal",function(){showFrameModal({title:aS.data("title"),description:"Your Wallet Balance is <b>"+formatBTC(ax)+"</b>",src:root+"withdraw?method="+aS.data("type")+"&address="+aT+"&balance="+ax+"&guid="+M+"&sharedKey="+d})})})});$("#logout").click(h.logout);$("#refresh").click(function(){J();h.get_history()});$("#summary-n-tx-chart").click(function(){window.open(root+"charts/n-transactions?show_header=false&address="+h.getActiveAddresses().join("|"),null,"scroll=0,status=0,location=0,toolbar=0,width=1000,height=700")});$("#summary-received-chart").click(function(){window.open(root+"charts/received-per-day?show_header=false&address="+h.getActiveAddresses().join("|"),null,"scroll=0,status=0,location=0,toolbar=0,width=1000,height=700")});$("#summary-balance-chart").click(function(){window.open(root+"charts/balance?show_header=false&address="+h.getActiveAddresses().join("|"),null,"scroll=0,status=0,location=0,toolbar=0,width=1000,height=700")});$("#new-addr").click(function(){try{J(function(){h.getSecondPassword(function(){var aU=h.generateNewKey();if(!aU){return}var aT=aU.getBitcoinAddress().toString();h.backupWallet("update",function(){h.makeNotice("info","new-address","Generated new Bitcoin Address "+aT);loadScript("wallet/address_modal",function(){showLabelAddressModal(aT)})})})})}catch(aS){h.makeNotice("error","misc-error",aS)}});$(".tx_filter a").click(function(){av=0;aq=$(this).data("value");h.get_history()});$(".tx_display a").click(function(){var aS=$(this).data("value");if(aS=="export"){v();return}s.tx_display=aS;c();ah()});$("#email-backup-btn").click(function(){G()});$("#dropbox-backup-btn").click(function(){window.open(root+"wallet/dropbox-login?guid="+M+"&sharedKey="+d)});$("#gdrive-backup-btn").click(function(){window.open(root+"wallet/gdrive-login?guid="+M+"&sharedKey="+d)});$("#large-summary").click(function(){toggleSymbol();c()});$("#send-quick").on("show",function(aU,aT){var aS=$(this);r(aS,aT);aS.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aS,"quick",initNewTx())})})});$("#send-email").on("show",function(aU,aT){var aS=$(this);r(aS,aT);aS.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aS,"email",initNewTx())})})});$("#send-shared").on("show",function(aU,aT){var aS=$(this);r(aS,aT);aS.find(".mixer_fee").text(x);aS.find(".fees,.free,.bonus").show();if(x<0){aS.find(".fees,.free").hide()}else{if(x==0){aS.find(".fees,.bonus").hide()}else{aS.find(".free,.bonus").hide()}}aS.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aS,"shared",initNewTx())})});aS.find(".shared-fees").text("0.00");aS.find('input[name="send-before-fees"]').unbind().bind("keyup change",function(){var aW=parseFloat($(this).val());var aV=0;if(aW>0){if(x>0){aV=parseFloat(aW+((aW/100)*x))}else{aV=parseFloat(aW);aS.find(".bonus-value").text(formatPrecision((Math.min(aW,precisionFromBTC(200))/100)*x))}}if(precisionToBTC(aW)<0.1||precisionToBTC(aW)>250){aS.find(".shared-fees").text("0.00");aS.find(".send").prop("disabled",true)}else{aS.find(".shared-fees").text(formatBTC(aV*symbol_btc.conversion));aS.find(".send").prop("disabled",false)}aS.find('input[name="send-value"]').val(aV).trigger("keyup")})});$("#send-custom").on("show",function(aU,aT){var aS=$(this);r(aS,aT);aS.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aS,"custom",initNewTx())})});aS.find('select[name="from"]').unbind().change(function(){var aX=0;var aV=$(this).val();for(var aW in aV){if(aV[aW]=="any"){$(this).val("any");aX=ax;break}else{var aY=I[aV[aW]];if(aY&&aY.balance){aX+=aY.balance}}}aS.find(".amount-available").text(formatBTC(aX))}).trigger("change");aS.find(".reset").unbind().click(function(){r(aS,true);aS.find('select[name="from"]').trigger("change")})});$("#send-satoshi-dice,#send-btcdice-dice").on("show",function(aU,aT){var aS=this;loadScript("wallet/dicegames",function(){try{DICEGame.init($(aS))}catch(aV){h.makeNotice("error","misc-error","Unable To Load Dice Bets")}},function(aV){h.makeNotice("error","misc-error",aV)})});$("#send-sms").on("show",function(aU,aT){if(aT){return}var aS=$(this);r(aS);$.ajax({type:"GET",url:resource+"wallet/country_codes.html",success:function(aV){aS.find('select[name="sms-country-code"]').html(aV)},error:function(){h.makeNotice("error","misc-error","Error Downloading SMS Country Codes")}});aS.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){var aV=initNewTx();startTxUI(aS,"sms",aV)})})});$("#address-book").on("show",function(){var aT=$("#address-book-tbl tbody");if(aC(g)>0){aT.empty();for(var aS in g){var aU=$("<tr><td>"+g[aS]+'</td><td><div class="addr-book-entry">'+aS+'</div></td><td style="width:16px" class="hidden-phone"><img src="'+resource+'delete.png" class="act-delete" /></td></tr>');(function(aV){aU.find(".act-delete").click(function(){h.deleteAddressBook(aV)})})(aS);aT.append(aU)}}});$('a[data-toggle="tab"]').unbind().on("show",function(aS){$(aS.target.hash).trigger("show")});$("#receive-coins-btn").click(function(){ae($("#receive-coins"))});$(".show_adv").click(function(){$(".modal:visible").center()});$(".download-backup-btn").show();aB()}function p(){$(".resend-code").click(function(){h.setGUID(M,true)});$("#reset-two-factor-btn").click(function(){window.location=root+"wallet/reset-two-factor"+(M?"?guid="+M:"")});$(".recover-wallet-btn").click(function(){window.location=root+"wallet/forgot-password"+(M?"?guid="+M:"")});$(".download-backup-btn").toggle(ai!=null).click(function(){$(this).attr("download","wallet.aes.json");if(!ai){h.makeNotice("error","error","No Wallet Data to Download");return}var aT=("download" in document.createElement("a"));if(window.Blob&&window.URL&&aT){var aU=new Blob([ai]);var aV=window.URL.createObjectURL(aU);$(this).attr("href",aV)}else{var aS=window.open(null,null,"width=700,height=800,toolbar=0");aS.document.write('<!DOCTYPE html><html><head></head><body><div style="word-wrap:break-word;" >'+ai+"</div></body></html>")}aP()});$(".auth-0,.auth-1,.auth-2,.auth-3,.auth-4,.auth-5").unbind().keypress(function(aS){if(aS.keyCode==13){aS.preventDefault();$("#restore-wallet-continue").click()}});$("#restore-wallet-continue").unbind().click(function(aT){aT.preventDefault();var aS=$.trim($("#restore-guid").val());if(aS.length==0){return}if(M!=aS){h.setGUID(aS,false)}else{a()}});$(".modal").on("show",function(){L();$(this).center()}).on("shown",function(){L();$(this).center()})}function al(aT){var aU=Crypto.SHA256(aT+"?");switch(aU.slice(0,2)){case"00":var aV=Crypto.SHA256(aT,{asBytes:true});return aV;break;case"01":var aS=Crypto.util.hexToBytes(aU.slice(2,4))[0];var aW=Math.round(Math.pow(2,(aS/4)));var aV=Crypto.PBKDF2(aT,"Satoshi Nakamoto",32,{iterations:aW,asBytes:true});return aV;break;default:console.log("invalid key");break}}function aF(){var aU,aS="";if(window.getSelection){aU=window.getSelection();if(aU.rangeCount){var aV=aU.getRangeAt(0).cloneContents();var aT=document.createElement("div");aT.appendChild(aV);aS=aT.innerText}}else{if(document.selection&&document.selection.type=="Text"){aS=document.selection.createRange().htmlText}}return aS}this.detectPrivateKeyFormat=function(aT){if(/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(aT)){return"sipa"}if(/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(aT)){return"compsipa"}if(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{44}$/.test(aT)||/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{43}$/.test(aT)){return"base58"}if(/^[A-Fa-f0-9]{64}$/.test(aT)){return"hex"}if(/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(aT)){return"base64"}if(/^6P[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{56}$/.test(aT)){return"bip38"}if(/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(aT)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(aT)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(aT)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{30}$/.test(aT)){var aS=Crypto.SHA256(aT+"?",{asBytes:true});if(aS[0]===0||aS[0]===1){return"mini"}}throw"Unknown Key Format "+aT};this.privateKeyStringToKey=function(aT,aV){var aS=null;if(aV=="base58"){aS=B58.decode(aT)}else{if(aV=="base64"){aS=Crypto.util.base64ToBytes(aT)}else{if(aV=="hex"){aS=Crypto.util.hexToBytes(aT)}else{if(aV=="mini"){aS=al(aT)}else{if(aV=="sipa"){var aU=B58.decode(aT);aU.shift();aS=aU.slice(0,aU.length-4)}else{if(aV=="compsipa"){var aU=B58.decode(aT);aU.shift();aU.pop();aS=aU.slice(0,aU.length-4)}else{throw"Unsupported Key Format"}}}}}}if(aS.length!=32){throw"Result not 32 bytes in length"}return new Bitcoin.ECKey(aS)};$(document).ready(function(){if(!$.isEmptyObject({})){h.makeNotice("error","error","Object.prototype has been extended by a browser extension. Please disable this extensions and reload the page.");return}$("input,button,select").attr("autocomplete","off");var aT=$(document.body);function aU(){if(M&&M.length==36){setTimeout(function(){h.setGUID(M,false)},10)}}M=aT.data("guid");d=aT.data("sharedkey");if(h.skip_init){return}MyStore.get("payload",function(aZ){if(ai==null&&aZ!=null){ai=aZ;ay=ag()}});if((!M||M.length==0)&&(isExtension||window.location.href.indexOf("/login")>0)){MyStore.get("guid",function(aZ){M=aZ;aU()})}else{aU()}if(top.location!=self.location){top.location=self.location.href}aT.click(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).keypress(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).mousemove(function(aZ){if(aZ){rng_seed_int(aZ.clientX*aZ.clientY)}});p();$(".auth-"+q).show();j=$("#restore-wallet");j.show();var aV=false;var aY=17,aX=86,aS=67,aW=67;$(document).keydown(function(a0){try{if(a0.keyCode==aY||a0.keyCode==aW){aV=true}if(aV&&a0.keyCode==aS){var aZ=$.trim(aF());var a1=I[aZ];if(a1!=null){if(a1.priv==null){$("#watch-only-copy-warning-modal").modal("show")}else{if(a1.tag==1){O()}}}}}catch(a0){console.log(a0)}}).keyup(function(aZ){if(aZ.keyCode==aY||aZ.keyCode==aW){aV=false}}).ajaxStart(function(){at("loading_start");$(".loading-indicator").fadeIn(200)}).ajaxStop(function(){at("loading_stop");$(".loading-indicator").hide()})});function aR(){$("#receive-coins").find(".tab-pane.active").trigger("show");setupToggle()}};